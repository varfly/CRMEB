require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/goods/order_confirm/index"],{"5fb0":function(t,i,e){"use strict";e.r(i);var s=e("caa7"),n=e("d04e");for(var a in n)["default"].indexOf(a)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(a);e("8585");var o=e("828b"),r=Object(o["a"])(n["default"],s["b"],s["c"],!1,null,"d79ca4fc",null,!1,s["a"],void 0);i["default"]=r.exports},8585:function(t,i,e){"use strict";var s=e("fedb"),n=e.n(s);n.a},caa7:function(t,i,e){"use strict";e.d(i,"b",(function(){return s})),e.d(i,"c",(function(){return n})),e.d(i,"a",(function(){}));var s=function(){var t=this,i=t.$createElement,e=(t._self._c,t.virtual_type||t.is_gift&&2!=t.is_gift||!t.store_self_mention||!t.is_shipping?null:t.$t("快递配送")),s=t.virtual_type||t.is_gift&&2!=t.is_gift||!t.store_self_mention||!t.is_shipping?null:t.$t("到店自提"),n=t.virtual_type||t.is_gift&&2!=t.is_gift||t.store_self_mention&&t.is_shipping||0!=t.shippingType?null:t.$t("由平台为您提供配送服务"),a=t.virtual_type||t.is_gift&&2!=t.is_gift||t.store_self_mention&&t.is_shipping||1!=t.shippingType?null:t.$t("线上下单，到店自提"),o=t.virtual_type||t.is_gift&&2!=t.is_gift||t.store_self_mention&&t.is_shipping||0!=t.shippingType?null:t.$t("切换地址"),r=t.virtual_type||t.is_gift&&2!=t.is_gift||t.store_self_mention&&t.is_shipping||0==t.shippingType?null:t.$t("切换门店"),c=t.virtual_type||t.is_gift&&2!=t.is_gift||0!=t.shippingType||!t.addressInfo.real_name||!t.addressInfo.is_default?null:t.$t("默认"),d=t.virtual_type||t.is_gift&&2!=t.is_gift||0!=t.shippingType||t.addressInfo.real_name?null:t.$t("设置收货地址"),u=t.virtual_type||t.is_gift&&2!=t.is_gift||0==t.shippingType?null:t.storeList.length,l=t.virtual_type||t.is_gift&&2!=t.is_gift||0==t.shippingType||u>0?null:t.$t("暂无门店信息"),p=t.virtual_type||t.is_gift&&2!=t.is_gift||0==t.shippingType?null:t.storeList.length,f=1==t.is_gift?t.$t("好友留言"):null,g=1==t.is_gift?t.$t("填写好友留言，最多40字"):null,h=t.is_gift||2!=t.is_gift||1!=t.shippingType?null:t.$t("用户姓名"),_=t.is_gift||2!=t.is_gift||1!=t.shippingType?null:t.$t("请输入姓名"),m=t.is_gift||2!=t.is_gift||1!=t.shippingType?null:t.$t("联系电话"),I=t.is_gift||2!=t.is_gift||1!=t.shippingType?null:t.$t("请输入手机号"),v=t.is_gift&&1!=t.is_gift||t.pinkId||t.BargainId||t.combinationId||t.seckillId||t.noCoupon||t.discountId||t.advanceId?null:t.$t("优惠券"),$=t.is_gift&&1!=t.is_gift||t.pinkId||t.BargainId||t.combinationId||t.seckillId||t.advanceId||!t.integral_open?null:t.$t("积分抵扣"),y=t.is_gift&&1!=t.is_gift||t.pinkId||t.BargainId||t.combinationId||t.seckillId||t.advanceId||!t.integral_open||!t.useIntegral?null:t.$t("剩余积分"),T=t.is_gift&&1!=t.is_gift||t.pinkId||t.BargainId||t.combinationId||t.seckillId||t.advanceId||!t.integral_open||t.useIntegral?null:t.$t("当前积分"),b=t.is_gift&&1!=t.is_gift||!t.invoice_func&&!t.special_invoice?null:t.$t("开具发票"),k=t.is_gift&&1!=t.is_gift||1!=t.shippingType?null:t.$t("用户姓名"),P=t.is_gift&&1!=t.is_gift||1!=t.shippingType?null:t.$t("请输入姓名"),w=t.is_gift&&1!=t.is_gift||1!=t.shippingType?null:t.$t("联系电话"),C=t.is_gift&&1!=t.is_gift||1!=t.shippingType?null:t.$t("请输入手机号"),L=t.is_gift&&1!=t.is_gift||!t.textareaStatus?null:t.$t("备注说明"),S=t.is_gift&&1!=t.is_gift||!t.textareaStatus||t.coupon.coupon||t.inputTrip?null:t.mark||t.$t("填写备注信息，100字以内"),x=t.is_gift&&1!=t.is_gift||!t.textareaStatus||t.coupon.coupon||!t.inputTrip?null:t.$t("填写备注信息，100字以内"),G=t.confirm.length&&(!t.is_gift||1==t.is_gift),A=G?t.__map(t.confirm,(function(i,e){var s=t.__get_orig(i),n="text"==i.label?t.$t("请填写"+i.title):null,a="number"==i.label?t.$t("请填写"+i.title):null,o="email"==i.label?t.$t("请填写"+i.title):null,r="id"==i.label?t.$t("请填写"):null,c="phone"==i.label?t.$t("请填写"):null,d="img"==i.label?i.value.length:null,u="img"==i.label&&d<8?t.$t("上传图片"):null;return{$orig:s,m27:n,m28:a,m29:o,m30:r,m31:c,g3:d,m32:u}})):null,D=t.is_gift&&1!=t.is_gift?null:t.$t("商品总价"),F=t.is_gift&&1!=t.is_gift?null:t.$t("￥"),B=(!t.is_gift||1==t.is_gift)&&t.is_gift&&t.priceGroup.giftPrice>0?t.$t("礼品附加费"):null,O=(!t.is_gift||1==t.is_gift)&&t.is_gift&&t.priceGroup.giftPrice>0?t.$t("￥"):null,W=(!t.is_gift||1==t.is_gift)&&t.is_gift&&t.priceGroup.giftPrice>0?parseFloat(t.priceGroup.giftPrice):null,N=t.is_gift&&1!=t.is_gift||!(t.priceGroup.storePostage>0||t.priceGroup.storePostageDiscount>0)?null:t.$t("配送运费"),z=t.is_gift&&1!=t.is_gift||!(t.priceGroup.storePostage>0||t.priceGroup.storePostageDiscount>0)?null:t.$t("￥"),K=t.is_gift&&1!=t.is_gift||!(t.priceGroup.storePostage>0||t.priceGroup.storePostageDiscount>0)?null:(parseFloat(t.priceGroup.storePostage)+parseFloat(t.priceGroup.storePostageDiscount)).toFixed(2),E=t.is_gift&&1!=t.is_gift||!(t.priceGroup.levelPrice>0)||!t.userInfo.vip||t.pinkId||t.BargainId||t.combinationId||t.seckillId||t.discountId?null:t.$t("用户等级优惠"),M=t.is_gift&&1!=t.is_gift||!(t.priceGroup.levelPrice>0)||!t.userInfo.vip||t.pinkId||t.BargainId||t.combinationId||t.seckillId||t.discountId?null:t.$t("￥"),j=t.is_gift&&1!=t.is_gift||!(t.priceGroup.levelPrice>0)||!t.userInfo.vip||t.pinkId||t.BargainId||t.combinationId||t.seckillId||t.discountId?null:parseFloat(t.priceGroup.levelPrice).toFixed(2),H=t.is_gift&&1!=t.is_gift||!(t.priceGroup.memberPrice>0)||!t.userInfo.vip||t.pinkId||t.BargainId||t.combinationId||t.seckillId||t.discountId?null:t.$t("付费会员优惠"),R=t.is_gift&&1!=t.is_gift||!(t.priceGroup.memberPrice>0)||!t.userInfo.vip||t.pinkId||t.BargainId||t.combinationId||t.seckillId||t.discountId?null:t.$t("￥"),U=t.is_gift&&1!=t.is_gift||!(t.priceGroup.memberPrice>0)||!t.userInfo.vip||t.pinkId||t.BargainId||t.combinationId||t.seckillId||t.discountId?null:parseFloat(t.priceGroup.memberPrice).toFixed(2),J=(!t.is_gift||1==t.is_gift)&&t.priceGroup.storePostageDiscount>0?t.$t("会员运费优惠"):null,Q=(!t.is_gift||1==t.is_gift)&&t.priceGroup.storePostageDiscount>0?t.$t("￥"):null,q=(!t.is_gift||1==t.is_gift)&&t.priceGroup.storePostageDiscount>0?parseFloat(t.priceGroup.storePostageDiscount).toFixed(2):null,Y=(!t.is_gift||1==t.is_gift)&&t.coupon_price>0?t.$t("优惠券抵扣"):null,V=(!t.is_gift||1==t.is_gift)&&t.coupon_price>0?t.$t("￥"):null,X=(!t.is_gift||1==t.is_gift)&&t.coupon_price>0?parseFloat(t.coupon_price).toFixed(2):null,Z=(!t.is_gift||1==t.is_gift)&&t.integral_price>0?t.$t("积分抵扣"):null,tt=(!t.is_gift||1==t.is_gift)&&t.integral_price>0?t.$t("￥"):null,it=(!t.is_gift||1==t.is_gift)&&t.integral_price>0?parseFloat(t.integral_price).toFixed(2):null,et=t.is_gift&&1!=t.is_gift?null:t.$t("合计"),st=t.is_gift&&1!=t.is_gift?null:t.$t("￥"),nt=t.is_gift&&1!=t.is_gift?null:t.valid_count>0&&!t.discount_id||t.valid_count==t.cartInfo.length&&t.discount_id,at=t.is_gift&&1!=t.is_gift||!nt?null:t.$t("提交订单"),ot=t.is_gift&&1!=t.is_gift||nt?null:t.$t("提交订单");t._isMounted||(t.e0=function(i){t.inputTrip=!1},t.e1=function(i){i.stopPropagation(),t.Debounce(t.SubOrder())}),t.$mp.data=Object.assign({},{$root:{m0:e,m1:s,m2:n,m3:a,m4:o,m5:r,m6:c,m7:d,g0:u,m8:l,g1:p,m9:f,m10:g,m11:h,m12:_,m13:m,m14:I,m15:v,m16:$,m17:y,m18:T,m19:b,m20:k,m21:P,m22:w,m23:C,m24:L,m25:S,m26:x,g2:G,l0:A,m33:D,m34:F,m35:B,m36:O,m37:W,m38:N,m39:z,g4:K,m40:E,m41:M,g5:j,m42:H,m43:R,g6:U,m44:J,m45:Q,g7:q,m46:Y,m47:V,g8:X,m48:Z,m49:tt,g9:it,m50:et,m51:st,g10:nt,m52:at,m53:ot}})},n=[]},d04e:function(t,i,e){"use strict";e.r(i);var s=e("e458"),n=e.n(s);for(var a in s)["default"].indexOf(a)<0&&function(t){e.d(i,t,(function(){return s[t]}))}(a);i["default"]=n.a},e458:function(t,i,e){"use strict";(function(t){var s=e("47a9");Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var n=e("1a5b"),a=e("a05e"),o=e("0729"),r=e("c302"),c=(e("3b12"),e("d7f8")),d=e("8f59"),u=s(e("0cf0")),l=s(e("95e5")),p={components:{payment:function(){Promise.all([e.e("common/vendor"),e.e("components/payment/index")]).then(function(){return resolve(e("4e69"))}.bind(null,e)).catch(e.oe)},invoicePicker:function(){e.e("pages/goods/components/invoicePicker/index").then(function(){return resolve(e("e4d4"))}.bind(null,e)).catch(e.oe)},couponListWindow:function(){Promise.all([e.e("common/vendor"),e.e("components/couponListWindow/index")]).then(function(){return resolve(e("aba3"))}.bind(null,e)).catch(e.oe)},addressWindow:function(){e.e("components/addressWindow/index").then(function(){return resolve(e("1c6d"))}.bind(null,e)).catch(e.oe)},orderGoods:function(){e.e("components/orderGoods/index").then(function(){return resolve(e("a51a"))}.bind(null,e)).catch(e.oe)},home:function(){Promise.all([e.e("common/vendor"),e.e("components/home/index")]).then(function(){return resolve(e("05b1"))}.bind(null,e)).catch(e.oe)},authorize:function(){e.e("components/Authorize").then(function(){return resolve(e("636c"))}.bind(null,e)).catch(e.oe)}},mixins:[u.default,l.default],data:function(){this.getDate({format:!0});return{confirm:"",date:this.$t("请选择"),time:this.$t("请选择"),canvasWidth:"",canvasHeight:"",canvasStatus:!1,newImg:[],textareaStatus:!0,cartArr:[{name:this.$t("微信支付"),icon:"icon-weixin2",value:"weixin",title:this.$t("使用微信快捷支付"),payStatus:1},{name:this.$t("支付宝支付"),icon:"icon-zhifubao",value:"alipay",title:this.$t("使用支付宝支付"),payStatus:1},{name:this.$t("余额支付"),icon:"icon-yuezhifu",value:"yue",title:this.$t("可用余额"),payStatus:1},{name:this.$t("线下支付"),icon:"icon-yuezhifu1",value:"offline",title:this.$t("使用线下付款"),payStatus:2},{name:this.$t("好友代付"),icon:"icon-haoyoudaizhifu",value:"friend",title:this.$t("找微信好友支付"),payStatus:1}],virtual_type:0,allPrice:0,formContent:"",payType:"",openType:1,active:0,coupon:{coupon:!1,list:[],statusTile:this.$t("立即使用")},address:{address:!1},addressInfo:{},pinkId:0,addressId:0,couponId:0,cartId:"",orderId:"",BargainId:0,combinationId:0,seckillId:0,discountId:0,userInfo:{},mark:"",couponTitle:this.$t("请选择"),coupon_price:0,useIntegral:!1,integral_price:0,integral:0,usable_integral:0,ChangePrice:0,formIds:[],status:0,is_address:!1,toPay:!1,shippingType:0,system_store:{},storePostage:0,advanceId:0,gift_mark:"这是送您的一份礼物~",contacts:"",contactsTel:"",mydata:{},storeList:[],store_self_mention:0,cartInfo:[],priceGroup:{},animated:!1,totalPrice:0,integralRatio:"0",pagesUrl:"",orderKey:"",offlinePostage:"",isAuto:!1,isShowAuth:!1,from:"",news:1,invTitle:this.$t("不开发票"),special_invoice:!1,invoice_func:!1,header_type:"",invShow:!1,invList:[],invChecked:"",urlQuery:"",pay_close:!1,noCoupon:0,valid_count:0,discount_id:0,is_shipping:!0,inputTrip:!1,focus:!0,integral_open:!1,jumpData:{},is_gift:0,giftData:null}},computed:(0,d.mapGetters)(["isLogin"]),onLoad:function(t){if(this.from="routine",!t.cartId&&!t.order_id)return this.$util.Tips({title:this.$t("请选择要购买的商品")},{tab:3,url:1});if(t.is_gift&&(this.is_gift=Number(t.is_gift)),this.couponId=t.couponId||0,this.noCoupon=Number(t.noCoupon)||0,this.pinkId=t.pinkId?parseInt(t.pinkId):0,this.addressId=t.addressId||0,this.cartId=t.cartId,this.orderId=t.order_id||0,this.is_address=!!t.is_address,this.news=t.new&&"0"!==t.new?1:0,this.invChecked=t.invoice_id||"",this.header_type=t.header_type||"1",this.couponTitle=t.couponTitle||this.$t("请选择"),t.invoice_id){var i="";i+=1==t.header_type?this.$t("个人"):this.$t("企业"),i+=1==t.invoice_type?this.$t("普通"):this.$t("专用"),i+=this.$t("发票"),this.invTitle=i}this.textareaStatus=!0,!this.isLogin||0!=this.toPay||0!=this.is_gift&&1!=this.is_gift?this.is_gift&&this.isLogin?this.getOrderDetail():(0,c.toLogin)():this.checkShipping()},onShow:function(){var i=this;t.$on("handClick",(function(e){e&&(i.system_store=e.address),t.$off("handClick")}))},methods:{checkShipping:function(){var i=this,e=this;(0,n.checkShipping)(e.cartId,e.news).then((function(t){0==t.data.type?(e.is_shipping=!0,e.shippingType=0,i.getaddressInfo(),i.getConfirm(),i.$nextTick((function(){this.$refs.addressWindow.getAddressList()}))):1==t.data.type?(e.is_shipping=!1,e.shippingType=0,i.getaddressInfo(),i.getConfirm(),i.$nextTick((function(){this.$refs.addressWindow.getAddressList()}))):2==t.data.type&&(e.is_shipping=!1,e.shippingType=1,i.addressType(1),i.getConfirm(),i.getList())})).catch((function(i){t.showToast({title:i,icon:"none"})}))},invCancel:function(){this.invChecked="",this.invTitle=this.$t("不开发票"),this.invShow=!1},invChange:function(t){var i="";this.invChecked=t,this.invShow=!1;var e=this.invList.find((function(i){return i.id===t}));i+=1===e.header_type?this.$t("个人"):this.$t("企业"),i+=1===e.type?this.$t("普通"):this.$t("专用"),i+=this.$t("发票"),this.invTitle=i},openList:function(){0==this.shippingType?this.onAddress():this.showStoreList()},invClose:function(){this.invShow=!1,this.getInvoiceList()},getInvoiceList:function(){var i=this;t.showLoading({title:this.$t("正在加载中")}),(0,a.invoiceList)().then((function(e){t.hideLoading(),i.invList=e.data.map((function(t){return t.id=t.id.toString(),t}));var s=i.invList.find((function(t){return t.id==i.invChecked}));if(s){var n="";n+=1===s.header_type?i.$t("个人"):i.$t("企业"),n+=1===s.type?i.$t("普通"):i.$t("专用"),n+=i.$t("发票"),i.invTitle=n}})).catch((function(i){t.showToast({title:i,icon:"none"})}))},goInvoice:function(){this.getInvoiceList(),this.invShow=!0,this.urlQuery="new=".concat(this.news,"&cartId=").concat(this.cartId,"&pinkId=").concat(this.pinkId,"&couponId=").concat(this.couponId,"&addressId=").concat(this.addressId,"&specialInvoice=").concat(this.special_invoice,"&couponTitle=").concat(this.couponTitle)},onLoadFun:function(){this.getaddressInfo(),this.getConfirm()},onChangeFun:function(t){var i=t,e=i.action||null,s=void 0!=i.value?i.value:null;e&&this[e]&&this[e](s)},payClose:function(){this.pay_close=!1},goPay:function(){this.pay_close=!0},payCheck:function(t){this.payType=t,this.SubOrder()},getList:function(){var i=this,e=t.getStorageSync("user_longitude")||"",s=t.getStorageSync("user_latitude")||"",n={latitude:s,longitude:e,page:1,limit:10};(0,r.storeListApi)(n).then((function(t){var e=t.data.list.list||[];i.$set(i,"storeList",e),i.$set(i,"system_store",e[0])})).catch((function(t){}))},changeClose:function(){this.$set(this.address,"address",!1)},showStoreList:function(){this.storeList.length>0&&t.navigateTo({url:"/pages/goods/goods_details_store/index"})},changePayType:function(t){this.payType=t,this.computedPrice()},computedPrice:function(){var t=this,i=this.shippingType,e={addressId:this.addressId,useIntegral:this.useIntegral?1:0,couponId:this.couponId,shipping_type:parseInt(i)+1,payType:this.payType};this.is_gift&&(e.is_gift=this.is_gift),(0,n.postOrderComputed)(this.orderKey,e).then((function(e){var s=e.data.result;s&&(t.totalPrice=s.pay_price,t.integral_price=s.deduction_price,t.coupon_price=s.coupon_price,t.integral=t.useIntegral?s.SurplusIntegral:t.usable_integral,t.$set(t.priceGroup,"storePostage",1==i?0:s.pay_postage),t.$set(t.priceGroup,"storePostageDiscount",s.storePostageDiscount))}))},addressType:function(i){var e=this,s=i;this.shippingType!=parseInt(s)&&(this.shippingType=parseInt(s),1==s&&t.getLocation({type:"wgs84",success:function(i){t.setStorageSync("user_latitude",i.latitude),t.setStorageSync("user_longitude",i.longitude)},complete:function(){e.getList()}}),this.$nextTick((function(t){e.is_gift||(e.getConfirm(),e.computedPrice())})))},bindPickerChange:function(t){var i=t.detail.value;this.shippingType=i,this.computedPrice()},ChangCouponsClone:function(){this.$set(this.coupon,"coupon",!1)},changeTextareaStatus:function(){for(var t=0,i=this.coupon.list.length;t<i;t++)this.coupon.list[t].use_title="",this.coupon.list[t].is_use=0;this.textareaStatus=!0,this.status=0,this.$set(this.coupon,"list",this.coupon.list)},ChangCoupons:function(t){for(var i=t,e=this.coupon.list,s=this.$t("请选择"),n=0,a=0,o=e.length;a<o;a++)a!=i&&(e[a].use_title="",e[a].is_use=0);e[i].is_use?(e[i].use_title="",e[i].is_use=0):(e[i].use_title=this.$t("不使用"),e[i].is_use=1,s=e[i].coupon_title,n=e[i].id),this.couponTitle=s,this.couponId=n,this.$set(this.coupon,"coupon",!1),this.$set(this.coupon,"list",e),this.computedPrice()},ChangeIntegral:function(){this.useIntegral=!this.useIntegral,this.computedPrice()},OnChangeAddress:function(t){this.textareaStatus=!0,this.addressId=t,this.address.address=!1,this.getaddressInfo(),this.is_gift||(this.getConfirm(),this.computedPrice())},bindHideKeyboard:function(t){this.mark=t.detail.value},getOrderDetail:function(){var t=this;(0,n.getGiftOrderDetail)(this.orderId).then((function(i){t.giftData=i.data,t.$set(t,"cartInfo",i.data.cartInfo),t.virtual_type=i.data.type,t.store_self_mention=i.data.store_self_mention,0==i.data.type?(t.is_shipping=!0,t.shippingType=0,t.getaddressInfo(),t.$nextTick((function(){t.$refs.addressWindow.getAddressList()}))):1==i.data.type?(t.is_shipping=!1,t.shippingType=0,t.getaddressInfo(),t.$nextTick((function(){t.$refs.addressWindow.getAddressList()}))):2==i.data.type&&(t.is_shipping=!1,t.shippingType=1,t.addressType(1),t.getList())}))},getConfirm:function(){var i=this,e=this;t.showLoading({title:e.$t("正在加载中"),mask:!0});var s={cartId:e.cartId,new:e.news,addressId:e.addressId,shipping_type:e.shippingType+1};e.is_gift&&(s.is_gift=e.is_gift),(0,n.orderConfirm)(s).then((function(s){e.$set(e,"userInfo",s.data.userInfo),e.$set(e,"confirm",s.data.custom_form||[]),i.confirm.map((function(t){"img"===t.label&&(t.value=[])})),e.$set(e,"integral",s.data.usable_integral),e.$set(e,"usable_integral",s.data.usable_integral),e.$set(e,"contacts",s.data.userInfo.real_name),e.$set(e,"contactsTel","0"===s.data.userInfo.record_phone?s.data.userInfo.phone:s.data.userInfo.record_phone),e.$set(e,"cartInfo",s.data.cartInfo),e.$set(e,"integralRatio",s.data.integralRatio),e.$set(e,"offlinePostage",s.data.offlinePostage),e.$set(e,"orderKey",s.data.orderKey),e.$set(e,"valid_count",s.data.valid_count),e.$set(e,"discount_id",s.data.discount_id),e.$set(e,"priceGroup",s.data.priceGroup),e.$set(e,"totalPrice",e.$util.$h.Add(parseFloat(s.data.priceGroup.totalPrice),parseFloat(s.data.priceGroup.storePostage))),e.$set(e,"allPrice",e.$util.$h.Add(parseFloat(s.data.priceGroup.totalPrice),parseFloat(s.data.priceGroup.vipPrice)).toFixed(2)),e.$set(e,"seckillId",parseInt(s.data.seckill_id)),e.$set(e,"invoice_func",s.data.invoice_func),e.$set(e,"special_invoice",s.data.special_invoice),e.$set(e,"store_self_mention",s.data.store_self_mention),e.$set(e,"virtual_type",s.data.virtual_type||0),e.$set(e,"integral_open",s.data.integral_open),t.hideLoading(),e.cartArr[0].payStatus=s.data.pay_weixin_open||0,e.cartArr[1].payStatus=s.data.ali_pay_status||0,e.cartArr[1].payStatus=0,e.cartArr[2].number=s.data.userInfo.now_money,e.cartArr[2].payStatus=1==s.data.yue_pay_status?s.data.yue_pay_status:0,2==s.data.offline_pay_status||s.data.deduction?e.cartArr[3].payStatus=0:e.cartArr[3].payStatus=1,e.cartArr[4].payStatus=s.data.friend_pay_status||0,e.$set(e,"ChangePrice",e.totalPrice),e.getBargainId(),setTimeout((function(){e.getCouponList()}),500),i.addressId&&!i.is_gift&&i.computedPrice()})).catch((function(e){return t.hideLoading(),i.$util.Tips({title:e})}))},getBargainId:function(){var t=this.cartInfo,i=0,e=0,s=0,n=0;t.forEach((function(t,a,o){i=o[a].bargain_id,e=o[a].combination_id,s=o[a].discount_id,n=o[a].advance_id})),this.$set(this,"BargainId",parseInt(i)),this.$set(this,"combinationId",parseInt(e)),this.$set(this,"discountId",parseInt(s)),this.$set(this,"advanceId",parseInt(n)),3==this.cartArr.length&&(i||e||this.seckillId||s)&&(this.cartArr[2].payStatus=0,this.$set(this,"cartArr",this.cartArr))},getCouponList:function(){var t=this,i=this.shippingType,e={cartId:this.cartId,new:this.news,shippingType:parseInt(i)+1};(0,n.getCouponsOrderPrice)(this.totalPrice,e).then((function(i){t.$set(t.coupon,"list",i.data),t.pinkId||t.BargainId||t.combinationId||t.seckillId||t.noCoupon||t.discountId||t.advanceId||t.coupon.list.length&&t.ChangCoupons(0),t.openType=1}))},getaddressInfo:function(){var t=this,i=t.addressId?a.getAddressDetail:a.getAddressDefault;i(t.addressId).then((function(i){Array.isArray(i.data)||(i.data.is_default=parseInt(i.data.is_default),t.addressInfo=i.data||{},t.addressId=i.data.id||0,t.address.addressId=i.data.id||0)}))},onHaveAddressList:function(){this.haveAddressList=!0},payItem:function(t){var i=this,e=t;i.active=e,i.animated=!0,i.payType=i.cartArr[e].value,i.computedPrice(),setTimeout((function(){i.car()}),500)},couponTap:function(){var t=this;this.coupon.coupon=!0,this.coupon.list.forEach((function(i,e){i.id==t.couponId?i.is_use=1:i.is_use=0})),this.$set(this.coupon,"list",this.coupon.list)},car:function(){this.animated=!1},onAddress:function(){if(this.addressInfo.real_name||this.haveAddressList)this.$refs.addressWindow.getAddressList(),this.textareaStatus=!1,this.address.address=!0,this.pagesUrl="/pages/users/user_address_list/index?news="+this.news+"&cartId="+this.cartId+"&pinkId="+this.pinkId+"&couponId="+this.couponId+"&is_gift="+this.is_gift+"&order_id="+this.orderId;else{var i="/pages/users/user_address/index?cartId="+this.cartId+"&pinkId="+this.pinkId+"&couponId="+this.couponId+"&new="+this.news+"&is_gift="+this.is_gift+"&order_id="+this.orderId;t.navigateTo({url:i})}},formpost:function(t,i){var e=document.createElement("form");for(var s in e.action=t,e.method="post",e.target="_self",e.style.display="none",i){var n=document.createElement("input");n.name=s,n.value=i[s],e.appendChild(n)}document.body.appendChild(e),this.$nextTick((function(t){e.submit()}))},payment:function(i){var e=this;(0,n.orderCreate)(e.orderKey,i).then((function(i){var e="/pages/goods/cashier/index?order_id=".concat(i.data.result.orderId,"&from_type=order");t.reLaunch({url:e})})).catch((function(i){return t.hideLoading(),e.$util.Tips({title:i})}))},clickTextArea:function(){this.$refs.textarea.focus()},SubOrder:function(i){var e=this,s={};if(!e.addressId&&!e.shippingType&&!e.virtual_type&&!e.is_gift)return e.$util.Tips({title:e.$t("请选择收货地址")});if(1==e.shippingType){if(""==e.contacts||""==e.contactsTel)return e.$util.Tips({title:e.$t("请填写联系人或联系人电话")});if(!/^1(3|4|5|7|8|9|6)\d{9}$/.test(e.contactsTel))return e.$util.Tips({title:e.$t("请输入正确的手机号码")});if(!e.contacts)return e.$util.Tips({title:e.$t("请输入姓名")});if(0==e.storeList.length)return e.$util.Tips({title:e.$t("暂无门店,请选择其他方式")})}for(var n=0;n<e.confirm.length;n++){var a=e.confirm[n];if(a.status){if(("text"===a.label||"data"===a.label||"time"===a.label||"id"===a.label)&&!a.value.trim())return t.showToast({title:e.$t("请输入")+"".concat(a.title),icon:"none"});if("number"===a.label&&a.value<=0)return t.showToast({title:e.$t("请输入")+"".concat(a.title),icon:"none"});if("email"===a.label&&!/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(a.value))return t.showToast({title:e.$t("请输入正确的")+"".concat(a.title),icon:"none"});if("phone"===a.label&&!/^1(3|4|5|7|8|9|6)\d{9}$/i.test(a.value))return t.showToast({title:e.$t("请输入正确的")+"".concat(a.title),icon:"none"});if("img"===a.label&&!a.value.length)return t.showToast({title:e.$t("请上传")+"".concat(a.title),icon:"none"})}}if(s={custom_form:e.confirm,gift_mark:e.gift_mark,real_name:e.contacts,phone:e.contactsTel,addressId:e.addressId,formId:"",couponId:e.couponId,useIntegral:e.useIntegral,bargainId:e.BargainId,combinationId:e.combinationId,discountId:e.discountId,pinkId:e.pinkId,advanceId:e.advanceId,seckill_id:e.seckillId,mark:e.mark,store_id:e.system_store?e.system_store.id:0,from:e.from,shipping_type:e.$util.$h.Add(e.shippingType,1),new:e.news,invoice_id:e.invChecked},e.is_gift&&(s.is_gift=e.is_gift),"yue"==s.payType&&parseFloat(e.userInfo.now_money)<parseFloat(e.totalPrice))return e.$util.Tips({title:e.$t("余额不足")});(0,o.openPaySubscribe)().then((function(){e.payment(s)}))},receiveGift:function(){var i=this,e={gift_key:this.giftData.gift_key,shipping_type:this.$util.$h.Add(this.shippingType,1),name:this.contacts,phone:this.contactsTel,address_id:this.addressId,store_id:this.system_store?this.system_store.id:0};(0,n.orderReceiveGift)(this.orderId,e).then((function(e){t.reLaunch({url:"/pages/goods/receive_gifts_status/index?status=".concat(e.data.status,"&order_id=").concat(i.giftData.order_id)})})).catch((function(i){t.showToast({title:i.msg})}))},bindDateChange:function(t,i){this.confirm[i].value=t.target.value},bindTimeChange:function(t,i){this.confirm[i].value=t.target.value},getDate:function(t){var i=new Date,e=i.getFullYear(),s=i.getMonth()+1,n=i.getDate();return"start"===t?e-=60:"end"===t&&(e+=2),s=s>9?s:"0"+s,n=n>9?n:"0"+n,"".concat(e,"-").concat(s,"-").concat(n)},uploadpic:function(t,i){var e=this;this.canvasStatus=!0,this.$util.uploadImageChange("upload/image",(function(t){i.value.push(t.data.url)}),(function(t){e.canvasStatus=!1}),(function(t){e.canvasWidth=t.w,e.canvasHeight=t.h}))},DelPic:function(t,i){this.confirm[t].value;this.confirm[t].value.splice(i,1)},inputTripClick:function(){this.inputTrip=!0},showMaoLocation:function(i){t.openLocation({latitude:Number(i.latitude),longitude:Number(i.longitude),name:i.name,address:"".concat(i.address,"-").concat(i.detailed_address),success:function(){}})},call:function(i){t.makePhoneCall({phoneNumber:i})}}};i.default=p}).call(this,e("df3c")["default"])},fa57:function(t,i,e){"use strict";(function(t,i){var s=e("47a9");e("2ea2");s(e("3240"));var n=s(e("5fb0"));t.__webpack_require_UNI_MP_PLUGIN__=e,i(n.default)}).call(this,e("3223")["default"],e("df3c")["createPage"])},fedb:function(t,i,e){}},[["fa57","common/runtime","common/vendor","pages/goods/common/vendor"]]]);