require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/annex/offline_pay/index"],{"2c05":function(t,e,a){},3789:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){}));var n=function(){var t=this,e=t.$createElement,a=(t._self._c,t.$t("支付金额")),n=t.$t("￥"),i=t.payPrice&&t.show?t.$t("会员优惠价"):null,o=t.payPrice&&t.show?t.$t("￥"):null,s=t.$t("支付方式"),c=t.yuePay?t.$t("余额支付"):null,r=t.yuePay?t.$t("可用余额"):null,u=t.yuePay?t.$t("￥"):null,l=t.wxpay?t.$t("微信支付"):null,p=t.$t("确认");t.$mp.data=Object.assign({},{$root:{m0:a,m1:n,m2:i,m3:o,m4:s,m5:c,m6:r,m7:u,m8:l,m9:p}})},i=[]},"5cca":function(t,e,a){"use strict";(function(t,n){var i=a("47a9");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a("1a5b"),s=a("d7f8"),c=a("8f59"),r=i(a("0cf0")),u=(getApp(),{mixins:[r.default],data:function(){return{money:"",payPrice:"",payType:"weixin",alipayHtml:"",alipay:!1,wxpay:!1,yuePay:!1,paying:!1,now_money:0,isWeixin:!1,site_name:"",isCommitted:!1,show:!1}},computed:(0,c.mapGetters)(["isLogin"]),onLoad:function(t){this.isLogin||(0,s.toLogin)()},onShow:function(){this.isLogin&&this.getPayType()},methods:{inputChange:function(t){var e=this;t.target.value=t.target.value.match(/^\d*(.?\d{0,2})/g)[0]||"",this.$nextTick((function(){e.money=t.target.value,e.checkPrice()}))},getPayType:function(){var e=this;(0,o.orderOfflinePayType)().then((function(a){var n=a.data,i=n.ali_pay_status,o=n.pay_weixin_open,s=n.yue_pay_status,c=n.offline_pay_status,r=n.site_name,u=n.now_money;e.alipay=i,e.wxpay=o,e.yuePay=s,e.now_money=u,e.site_name=r,c||t.showModal({title:e.$t("支付提醒"),content:e.$t("线下支付已关闭，请点击确认按钮返回主页"),showCancel:!1,success:function(){t.switchTab({url:"/pages/index/index"})}}),r&&t.setNavigationBarTitle({title:r})})).catch((function(e){t.showToast({title:e,icon:"none"})}))},checkForm:function(e){var a=e.detail.value,n=a.money,i=a.method;n?this.combData(i):t.showToast({title:this.$t("请输入支付金额"),icon:"none"})},checkPrice:function(){var e=this;(0,o.offlineCheckPrice)({pay_price:this.money}).then((function(t){e.payPrice=t.data.pay_price,e.show=t.data.show})).catch((function(e){t.showToast({title:e,icon:"none"})}))},combData:function(e){var a=this,n={type:3,pay_type:e,from:"routine",price:this.payPrice||this.money,money:this.money};n.from="routine",this.paying||(this.paying=!0,t.showLoading({title:this.$t("正在确认")}),(0,o.offlineCreate)(n).then((function(e){t.hideLoading(),a.callPay(e)})).catch((function(e){a.paying=!1,t.showToast({title:e,icon:"none"})})))},formpost:function(t,e){var a=document.createElement("form");for(var n in a.action=t,a.method="post",a.target="_self",a.style.display="none",e){var i=document.createElement("input");i.name=n,i.value=e[n],a.appendChild(i)}document.body.appendChild(a),this.$nextTick((function(t){a.submit()}))},callPay:function(e){var a=e.data,i=a.status,o=a.result,s=o.orderId,c=o.jsConfig,r="/pages/annex/offline_result/index?site_name="+this.site_name;switch(i){case"ORDER_EXIST":case"EXTEND_ORDER":case"ALLINPAY_PAY":t.hideLoading(),this.initIn=!0,n.openEmbeddedMiniProgram({appId:"wxef277996acc166c3",extraData:{cusid:c.cusid,appid:c.appid,version:c.version,trxamt:c.trxamt,reqsn:c.reqsn,notify_url:c.notify_url,body:c.body,remark:c.remark,validtime:c.validtime,randomstr:c.randomstr,paytype:c.paytype,sign:c.sign,signtype:c.signtype}}),this.jumpData={orderId:data.data.result.orderId,msg:data.msg};break;case"PAY_ERROR":this.paying=!1,this.$util.Tips({title:e.msg},{tab:5,url:r});break;case"SUCCESS":this.paying=!1,this.money="",this.$util.Tips({title:e.msg,icon:"success"},{tab:5,url:r});break;case"WECHAT_PAY":var u=this,l="";l=t.requestOrderPayment?"requestOrderPayment":"requestPayment",t[l]({timeStamp:c.timestamp,nonceStr:c.nonceStr,package:c.package,signType:c.signType,paySign:c.paySign,success:function(t){u.$util.Tips({title:u.$t("支付成功"),icon:"success"},{tab:5,url:"/pages/annex/offline_result/index"})},fail:function(){t.showToast({title:u.$t("取消支付"),icon:"none",success:function(){u.paying=!1}})},complete:function(){u.paying=!1,t.hideLoading()}});break;case"PAY_DEFICIENCY":this.paying=!1,this.$util.Tips({title:e.msg});break;case"WECHAT_H5_PAY":this.paying=!1,t.showToast({title:e.msg,success:function(){location.href=c.h5_url}});break;case"ALIPAY_PAY":this.paying=!1,t.navigateTo({url:"/pages/users/alipay_invoke/index?id=".concat(s,"&link=").concat(c.qrCode)});break}}}});e.default=u}).call(this,a("df3c")["default"],a("3223")["default"])},"879a":function(t,e,a){"use strict";a.r(e);var n=a("5cca"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=i.a},"9cbb":function(t,e,a){"use strict";(function(t,e){var n=a("47a9");a("2ea2");n(a("3240"));var i=n(a("ccfa"));t.__webpack_require_UNI_MP_PLUGIN__=a,e(i.default)}).call(this,a("3223")["default"],a("df3c")["createPage"])},a431:function(t,e,a){"use strict";var n=a("2c05"),i=a.n(n);i.a},aa3c:function(t,e,a){"use strict";var n=a("d1e6"),i=a.n(n);i.a},ccfa:function(t,e,a){"use strict";a.r(e);var n=a("3789"),i=a("879a");for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);a("aa3c"),a("a431");var s=a("828b"),c=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"ac0b9f7a",null,!1,n["a"],void 0);e["default"]=c.exports},d1e6:function(t,e,a){}},[["9cbb","common/runtime","common/vendor"]]]);