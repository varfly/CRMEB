(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-518bc085"],{"129f":function(e,t,a){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},"1a11":function(e,t,a){},2288:function(e,t,a){a("78ec")},"39d1d":function(e,t,a){a("1a11")},"46c47":function(e,t,a){a.d(t,"e",(function(){return n})),a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"h",(function(){return r})),a.d(t,"f",(function(){return d})),a.d(t,"d",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"i",(function(){return m}));var i=a("6b6c");function n(e){return Object(i.a)({url:"/setting/menus",method:"get",params:e})}function l(e){return Object(i.a)({url:"/setting/menus/unique",method:"get",params:e})}function s(){return Object(i.a)({url:"/setting/menus/create",method:"get"})}function o(e){return Object(i.a)({url:e.url,method:e.method,data:e.datas})}function r(e){return Object(i.a)({url:"/setting/menus/".concat(e),method:"get"})}function d(e){return Object(i.a)({url:"/setting/menus/show/".concat(e.id),method:"put",data:e})}function c(e){return Object(i.a)({url:"/setting/ruleList?cate_id=".concat(e),method:"get"})}function u(e){return Object(i.a)({url:"setting/menus/batch",method:"post",data:e})}function m(e){return Object(i.a)({url:"setting/rule_cate",method:"get"})}},"49e4":function(e,t,a){a("fa0a")},"59b4":function(e,t,a){a("5be9")},"5be9":function(e,t,a){},"6ea4":function(e,t,a){a("a9e3");var i={name:"",props:{stepList:{type:Array,default:function(){return[]}},isActive:{type:Number,default:0}},data:function(){return{}},created:function(){},mounted:function(){},methods:{lineWidth:function(){var e;switch(this.stepList.length){case 3:e="wd160";case 4:e="wd120";default:e="wd100"}return e},stepActive:function(e){this.$emit("stepActive",e)}}};a("eebf"),a=a("2877"),a=Object(a.a)(i,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"steps df-cc"},e._l(e.stepList,(function(a,i){return t("div",{directives:[{name:"db-click",rawName:"v-db-click"}],key:i,staticClass:"steps-item",class:i<=e.isActive?"active":"",on:{click:function(t){return e.stepActive(i)}}},[t("div",{staticClass:"dot df-cc"},[e._v(e._s(i+1))]),t("span",{staticClass:"title"},[e._v(e._s(a))]),i<e.stepList.length-1?t("div",{staticClass:"line",class:e.lineWidth()}):e._e()])})),0)}),[],!1,null,"4efc399c",null);t.a=a.exports},"78ec":function(e,t,a){},"80cc":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAeCAYAAAAhDE4sAAAAAXNSR0IArs4c6QAAAH9JREFUSEtjZGBgYNh/+HQDIyNjPIj9////hY62pg0gNi6ATT0jVLAeWdP///8bcRmGSz3jgSNn7jMwMCig2f7AwcZEEZuLcKmnnkFU8xrVAhtf7JAix0iKYnxqRw0iHJLgMBrNa+CAwplpR/MawYQ0mtcIBhHDaF5DhNHQyWsAiKzwBxioCkgAAAAASUVORK5CYII="},"841c":function(e,t,a){var i=a("c65b"),n=a("d784"),l=a("825a"),s=a("7234"),o=a("1d80"),r=a("129f"),d=a("577e"),c=a("dc4a"),u=a("14c3");n("search",(function(e,t,a){return[function(t){var a=o(this),n=s(t)?void 0:c(t,e);return n?i(n,t,a):new RegExp(t)[e](d(a))},function(e){var i=l(this),n=(e=d(e),a(t,i,e));return n.done?n.value:(n=i.lastIndex,r(n,0)||(i.lastIndex=0),e=u(i,e),r(i.lastIndex,n)||(i.lastIndex=n),null===e?-1:e.index)}]}))},a9e7:function(e,t,a){a.d(t,"i",(function(){return n})),a.d(t,"c",(function(){return l})),a.d(t,"g",(function(){return s})),a.d(t,"h",(function(){return o})),a.d(t,"e",(function(){return r})),a.d(t,"f",(function(){return d})),a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"d",(function(){return m})),a.d(t,"o",(function(){return f})),a.d(t,"j",(function(){return b})),a.d(t,"n",(function(){return p})),a.d(t,"k",(function(){return h})),a.d(t,"m",(function(){return v})),a.d(t,"l",(function(){return g})),a("99af");var i=a("6b6c");function n(){return Object(i.a)({url:"/system/crud/menus",method:"get"})}function l(){return Object(i.a)({url:"/system/crud/column_type",method:"get"})}function s(e){return Object(i.a)({url:"/system/crud/file_path",method:"post",data:e})}function o(e){return Object(i.a)({url:"/system/crud",method:"get",params:e})}function r(e){return Object(i.a)({url:"/system/crud/".concat(e),method:"get"})}function d(e){return Object(i.a)({url:"/system/crud/download/".concat(e),method:"get"})}function c(){return Object(i.a)({url:"/system/crud/association_table",method:"get"})}function u(e){return Object(i.a)({url:"/system/crud/association_table/".concat(e),method:"get"})}function m(e){return Object(i.a)({url:"/system/crud/data_dictionary/".concat(e),method:"get"})}function f(e,t){return Object(i.a)({url:"/system/crud/data_dictionary/".concat(e),method:"post",data:t})}function b(e,t){return Object(i.a)({url:"/system/crud/save_file/".concat(e),method:"post",data:t})}function p(e){return Object(i.a)({url:"/system/crud/data_dictionary_list",method:"get",params:e})}function h(e){return Object(i.a)({url:"/system/crud/data_dictionary_list/create/".concat(e),method:"get"})}function v(e){return Object(i.a)({url:"/system/crud/data_dictionary/info_list/".concat(e.id),method:"get",params:e})}function g(e,t,a){return Object(i.a)({url:"/system/crud/data_dictionary/info_create/".concat(e,"/").concat(t,"/").concat(a),method:"get"})}},b21d:function(e,t,a){a.r(t);var i=a("5530"),n=(a("caad"),a("d81d"),a("14d9"),a("b0c0"),a("a9e3"),a("d3b7"),a("159b"),a("90e7")),l=(a("a434"),a("a9e7")),s={name:"",props:{foundation:{type:Object,default:function(){return{}}}},data:function(){return{foundationRules:{tableName:[{required:!0,message:"请输入表名",trigger:"blur"}],modelName:[{required:!0,message:"请输入模块名",trigger:"blur"}]},menusList:[],columnTypeList:[],fromTypeList:[{value:"0",label:"不生成"},{value:"input",label:"input"},{value:"textarea",label:"textarea"},{value:"radio",label:"radio"},{value:"number",label:"number"},{value:"frameImageOne",label:"frameImageOne"},{value:"frameImages",label:"frameImages"}],loading:!1,tableField:[]}},created:function(){this.getCrudMenus()},mounted:function(){},methods:{disabledInput:function(e){var t=this.tableField[e];e=["addTimestamps","addSoftDelete"].includes(this.tableField[e].field_type);return t.primaryKey&&(e=!0),"delete_time"===t.field&&"timestamp"===t.field_type||e},initfield:function(){this.tableField=[]},changeItemField:function(e,t){"addSoftDelete"===e&&this.$set(this.tableField[t],"comment","伪删除"),"addTimestamps"===e&&this.$set(this.tableField[t],"comment","添加和修改时间")},getCrudMenus:function(){var e=this;Object(l.i)().then((function(t){e.menusList=t.data})),Object(l.c)().then((function(t){e.columnTypeList=t.data.types}))},del:function(e){this.tableField.splice(e,1)}}},o=(a("59b4"),a("2877")),r=(s=Object(o.a)(s,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"main"},[t("el-alert",{staticClass:"mb20",attrs:{closable:""},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("crud生成说明")]},proxy:!0}])},[[e._v(" 不能生成系统自带的表；已经生成过的表还能继续生成 ")]],2),t("el-form",{ref:"foundation",attrs:{model:e.foundation,rules:e.foundationRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"菜单："}},[t("el-cascader",{staticClass:"form-width",attrs:{size:"small",options:e.menusList,props:{checkStrictly:!0,multiple:!1,emitPath:!1},clearable:""},model:{value:e.foundation.pid,callback:function(t){e.$set(e.foundation,"pid",t)},expression:"foundation.pid"}}),t("div",{staticClass:"tip"},[e._v("选项，选择的菜单成功后会自动写入到此菜单下")])],1),t("el-form-item",{attrs:{label:"菜单名称："}},[t("el-input",{staticClass:"form-width",attrs:{placeholder:"请输入菜单名称"},model:{value:e.foundation.menuName,callback:function(t){e.$set(e.foundation,"menuName",t)},expression:"foundation.menuName"}}),t("div",{staticClass:"tip"},[e._v("\n        生成菜单为可选项，不填写默认生成的菜单名称将为表名；生成后会把自动生成的权限默认加入该菜单下\n      ")])],1),t("el-form-item",{attrs:{label:"模块名：",prop:"modelName"}},[t("el-input",{staticClass:"form-width",attrs:{placeholder:"请输入模块名"},model:{value:e.foundation.modelName,callback:function(t){e.$set(e.foundation,"modelName",t)},expression:"foundation.modelName"}}),t("div",{staticClass:"tip"},[e._v("模块名称为中文或者英文，用在接口名称前缀、表单头部标题")])],1),t("el-form-item",{attrs:{label:"表名：",prop:"tableName"}},[t("el-input",{staticClass:"form-width",attrs:{placeholder:"请输入表名"},model:{value:e.foundation.tableName,callback:function(t){e.$set(e.foundation,"tableName",t)},expression:"foundation.tableName"}}),t("div",{staticClass:"tip"},[e._v("\n        用于生成CRUD指定的表名，不需要携带表前缀；对于生成过的表将不能在进行生成；或者可以删除对应的文件重新生成！对应系统中重要的数据表将不允许生成！\n      ")])],1)],1)],1)}),[],!1,null,"9079022a",null).exports,a("ac1f"),a("841c"),a("2909")),d=(a("99af"),a("c740"),a("aa47")),c={name:"",props:{foundation:{type:Object,default:function(){return{}}},id:{type:String|Number}},data:function(){return{foundationRules:{},menusList:[],columnTypeList:[],optionsModal:!1,isCreate:!1,isDelete:!1,fromTypeList:[],loading:!1,tableField:[],optionsList:[],index:0,deleteField:[],searchType:[],dictionaryName:"",defaultType:[],associationTable:[],dictionaryList:[],props:{lazy:!0,options:this.associationTable,checkStrictly:!0,lazyLoad:function(e,t){e=e.value,e&&Object(l.b)(e).then((function(e){t(e.data)}))}}}},created:function(){this.getCrudMenus()},mounted:function(){var e=this;this.$nextTick((function(t){e.setSort()}))},methods:{beforeChange:function(){this.getCrudDataDictionary()},setSort:function(){var e=this,t=this.$refs.selection.$el.querySelectorAll(".el-table__body-wrapper > table > tbody")[0];this.sortable=d.a.create(t,{ghostClass:"sortable-ghost",handle:".handle",setData:function(e){e.setData("Text","")},onEnd:function(t){0===t.newIndex?setTimeout((function(){e.elChangeExForArray(t.oldIndex,t.newIndex,e.tableField,!0)}),100):e.elChangeExForArray(t.oldIndex,t.newIndex,e.tableField)}})},elChangeExForArray:function(e,t,a,i){var n=this,l=a,s=a[e];a=a[t];i?(l[t]=a,l[e]=s):(l[e]=a,l[t]=s),this.tableField=[],this.$nextTick((function(e){n.tableField=l}))},disabledInput:function(e){var t=this.tableField[e];e=["addTimestamps","addSoftDelete"].includes(this.tableField[e].field_type);return!!(t.primaryKey||"delete_time"===t.field&&"timestamp"===t.field_type||("create_time"===t.field||"update_time"===t.field)&&"timestamp"===t.field_type)||e},initfield:function(){this.tableField=[]},changeItemField:function(e,t){"addSoftDelete"===e&&this.$set(this.tableField[t],"comment","伪删除"),"addTimestamps"===e&&this.$set(this.tableField[t],"comment","添加和修改时间")},eidtOptions:function(e){var t=this;this.index=e,this.dictionaryId=this.tableField[e].dictionary_id||0,this.optionsModal=!0,this.dictionaryId?Object(l.d)(this.dictionaryId).then((function(e){t.dictionaryName=e.data.name,t.optionsList=e.data.value||[{label:"",value:""}]})):this.optionsList=[{label:"",value:""}]},addOptions:function(){var e=this,t={name:this.dictionaryName,value:this.optionsList};Object(l.o)(this.dictionaryId,t).then((function(t){e.optionsModal=!1,e.getCrudDataDictionary()}))},changeRadio:function(e){this.tableField=[],e&&this.addRow()},initTableName:function(){this.tableField=[]},addRow:function(){for(var e=0;e<this.tableField.length;e++){var t=this.tableField[e];if(!(t.field&&t.field_type||["addTimestamps","addSoftDelete"].includes(t.field_type)))return this.$message.warning("请先完善上一条数据");if(t.is_table&&!t.table_name&&!Number(t.primaryKey)&&!["addTimestamps","addSoftDelete"].includes(t.field_type))return this.$message.warning("请输入列表名")}this.tableField.length;var a,i=0;this.tableField.map((function(e){"create_time"!==e.field&&"update_time"!==e.field||i++,"delete_time"===e.field&&i++})),a=this.tableField.length-i,this.tableField.splice(a,0,{field:"",field_type:"",default:"",default_type:"-1",comment:"",required:!1,is_table:!0,table_name:"",limit:"",primaryKey:0,from_type:"",search:"",dictionary_id:0,hasOne:[],index:!1})},addCreate:function(e){var t=this;if(e){e=this.tableField.findIndex((function(e){return"create_time"===e.field}));var a=this.tableField.findIndex((function(e){return"update_time"===e.field}));if(0<e||0<a)return this.$nextTick((function(e){t.isCreate=!1})),this.$message.warning("已存在 create_time或update_time");this.tableField=[].concat(Object(r.a)(this.tableField),[{field:"create_time",field_type:"timestamp",default:"",default_type:"-1",comment:"添加时间",required:!1,is_table:!1,table_name:"添加时间",limit:"",primaryKey:0,from_type:"",search:"",dictionary_id:0,hasOne:[],index:!1},{field:"update_time",field_type:"timestamp",default_type:"-1",default:"",comment:"修改时间",required:!1,is_table:!1,table_name:"修改时间",limit:"",primaryKey:0,from_type:"",search:"",dictionary_id:0,hasOne:[],index:!1}])}else e=this.tableField.findIndex((function(e){return"create_time"===e.field})),this.tableField.splice(e,2)},addDelete:function(e){if(e){if(0<this.tableField.findIndex((function(e){return"delete_time"===e.field})))return this.isDelete=!1,this.$message.warning("已存在 delete_time");this.tableField=[].concat(Object(r.a)(this.tableField),[{field:"delete_time",field_type:"timestamp",default:"",default_type:"-1",comment:"伪删除",required:!1,is_table:!1,table_name:"伪删除",limit:"",primaryKey:0,from_type:"",search:"",dictionary_id:0,hasOne:[],index:!1}])}else e=this.tableField.findIndex((function(e){return"delete_time"===e.field})),this.tableField.splice(e,1)},changeField:function(e){if(this.tableField[e].field)for(var t=0;t<this.tableField.length;t++)if(this.tableField[t],["id","create_time","update_time","delete_time"].includes(this.tableField[e].field))return this.$message.warning("列表中已存在该字段名称"),void(this.tableField[e].field="")},changeComment:function(e,t){this.tableField[t].comment||(this.tableField[t].comment=e)},fromTypeChange:function(e,t){var a=this;this.fromTypeList.map((function(i){i.value==e&&(a.tableField[t].limit=i.limit||"",a.tableField[t].field_type=i.field_type||"")}))},getCrudMenus:function(){var e=this;Object(l.i)().then((function(t){e.menusList=t.data})),Object(l.c)().then((function(t){e.columnTypeList=t.data.types,e.fromTypeList=t.data.form,e.defaultType=t.data.default_type,e.searchType=t.data.search_type})),this.getCrudDataDictionary(),Object(l.a)().then((function(t){e.associationTable=t.data}))},getCrudDataDictionary:function(){var e=this;Object(l.n)().then((function(t){e.dictionaryList=t.data.list}))},getCrudAssociationTableName:function(e){Object(l.b)(e).then((function(e){}))},del:function(e,t){this.tableField.splice(t,1),this.id&&this.deleteField.push(e.field)},addOneOptions:function(){this.optionsList.push({label:"",value:""})},delOneOptions:function(e){this.optionsList.splice(e,1)}}},u=(c=(a("2288"),Object(o.a)(c,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"main"},[t("el-alert",{staticClass:"mb14",attrs:{closable:""},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("crud生成说明")]},proxy:!0}])},[[t("p",[e._v("\n        1、字段配置中表存在生成的字段为表内列的信息,并且主键、伪删除字段不允许设置为列，主键默认展示在列表中，伪删除字段不允许展示\n      ")]),t("p",[e._v("2、在字段配置中新建表时，主键不需要增加列，会自动增加一行主键id")]),t("p",[e._v("3、在字段配置中，表单类型为不生成时创建后不会生成对应的表单项")]),t("p",[e._v("4、添加字段id、create_time、update_time、delete_time为不可用字段")])]],2),t("div",{staticClass:"df mb14"},[t("el-button",{directives:[{name:"db-click",rawName:"v-db-click"}],staticClass:"mr20",attrs:{type:"primary"},on:{click:e.addRow}},[e._v("添加一行")]),t("el-checkbox",{staticClass:"mr10",on:{change:e.addCreate},model:{value:e.isCreate,callback:function(t){e.isCreate=t},expression:"isCreate"}},[e._v("添加与修改时间")]),t("el-checkbox",{staticClass:"mr10",on:{change:e.addDelete},model:{value:e.isDelete,callback:function(t){e.isDelete=t},expression:"isDelete"}},[e._v("伪删除")])],1),t("div",[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"selection",attrs:{data:e.tableField,"empty-text":"暂无数据","highlight-current-row":"","max-height":"600",size:"small"}},[t("el-table-column",{attrs:{label:"","min-width":"40"},scopedSlots:e._u([{key:"default",fn:function(i){return[e.disabledInput(i.$index)?e._e():t("div",{staticClass:"drag"},[t("img",{staticClass:"handle",attrs:{src:a("80cc"),alt:""}})])]}}])}),t("el-table-column",{attrs:{label:"表单名","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{disabled:e.disabledInput(a.$index)&&"id"==a.row.field},on:{change:function(t){return e.changeComment(t,a.$index)}},model:{value:a.row.table_name,callback:function(t){e.$set(a.row,"table_name",t)},expression:"scope.row.table_name"}})]}}])}),t("el-table-column",{attrs:{label:"表单类型","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{attrs:{clearable:"",disabled:e.disabledInput(a.$index)&&"id"==a.row.field},on:{change:function(t){return e.fromTypeChange(t,a.$index)}},model:{value:a.row.from_type,callback:function(t){e.$set(a.row,"from_type",t)},expression:"scope.row.from_type"}},e._l(e.fromTypeList,(function(e){return t("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})})),1)]}}])}),t("el-table-column",{attrs:{label:"数据字典","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(a){return[["select","radio","checkbox"].includes(a.row.from_type)?t("div",{staticClass:"table-options"},[t("el-select",{attrs:{clearable:""},model:{value:a.row.dictionary_id,callback:function(t){e.$set(a.row,"dictionary_id",t)},expression:"scope.row.dictionary_id"}},e._l(e.dictionaryList,(function(e){return t("el-option",{key:e.id,attrs:{value:e.id,label:e.name}})})),1)],1):t("div",[e._v("--")])]}}])}),t("el-table-column",{attrs:{label:"必填",width:"50"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-checkbox",{attrs:{disabled:e.disabledInput(a.$index)&&"id"==a.row.field},model:{value:a.row.required,callback:function(t){e.$set(a.row,"required",t)},expression:"scope.row.required"}})]}}])}),t("el-table-column",{attrs:{label:"查询方式","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{attrs:{slot:"prepend",clearable:"",disabled:e.disabledInput(a.$index),placeholder:"请选择"},slot:"prepend",model:{value:a.row.search,callback:function(t){e.$set(a.row,"search",t)},expression:"scope.row.search"}},e._l(e.searchType,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]}}])}),t("el-table-column",{attrs:{label:"列表",width:"50"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-checkbox",{attrs:{disabled:e.disabledInput(a.$index)&&"id"==a.row.field},model:{value:a.row.is_table,callback:function(t){e.$set(a.row,"is_table",t)},expression:"scope.row.is_table"}})]}}])}),t("el-table-column",{attrs:{label:"字段名称","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{disabled:e.disabledInput(a.$index)},on:{blur:function(t){return e.changeField(a.$index)}},model:{value:a.row.field,callback:function(t){e.$set(a.row,"field",t)},expression:"scope.row.field"}})]}}])}),t("el-table-column",{attrs:{label:"字段类型","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-select",{attrs:{disabled:e.disabledInput(a.$index),clearable:""},on:{change:function(t){return e.changeItemField(t,a.$index)}},model:{value:a.row.field_type,callback:function(t){e.$set(a.row,"field_type",t)},expression:"scope.row.field_type"}},e._l(e.columnTypeList,(function(e){return t("el-option",{key:e,attrs:{value:e,label:e}})})),1)]}}])}),t("el-table-column",{attrs:{label:"长度","min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(a){return["enum"!==a.row.field_type?t("el-input",{attrs:{disabled:e.disabledInput(a.$index)},model:{value:a.row.limit,callback:function(t){e.$set(a.row,"limit",t)},expression:"scope.row.limit"}}):t("el-select",{attrs:{multiple:"",filterable:"","allow-create":"",clearable:"","default-first-option":"",placeholder:"请添加"},model:{value:a.row.limit,callback:function(t){e.$set(a.row,"limit",t)},expression:"scope.row.limit"}})]}}])}),t("el-table-column",{attrs:{label:"默认值","min-width":"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{staticClass:"input-with-select",attrs:{disabled:e.disabledInput(a.$index)||"1"!==a.row.default_type},model:{value:a.row.default,callback:function(t){e.$set(a.row,"default",t)},expression:"scope.row.default"}},[t("el-select",{staticClass:"code-table-sel",staticStyle:{width:"100px"},attrs:{slot:"prepend",clearable:"",disabled:e.disabledInput(a.$index),placeholder:"请选择"},slot:"prepend",model:{value:a.row.default_type,callback:function(t){e.$set(a.row,"default_type",t)},expression:"scope.row.default_type"}},e._l(e.defaultType,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)]}}])}),t("el-table-column",{attrs:{label:"字段描述","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{disabled:e.disabledInput(a.$index)},model:{value:a.row.comment,callback:function(t){e.$set(a.row,"comment",t)},expression:"scope.row.comment"}})]}}])}),t("el-table-column",{attrs:{label:"关联表","min-width":"130"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-cascader",{attrs:{clearable:"",filterable:"",disabled:e.disabledInput(a.$index)&&"id"==a.row.field,options:e.associationTable,props:e.props},model:{value:a.row.hasOne,callback:function(t){e.$set(a.row,"hasOne",t)},expression:"scope.row.hasOne"}})]}}])}),t("el-table-column",{attrs:{label:"索引",width:"50"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-checkbox",{attrs:{disabled:e.disabledInput(a.$index)&&"id"==a.row.field},model:{value:a.row.index,callback:function(t){e.$set(a.row,"index",t)},expression:"scope.row.index"}})]}}])}),t("el-table-column",{attrs:{label:"操作",fixed:"right",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.primaryKey||e.disabledInput(a.$index)?t("span",[e._v("--")]):t("a",{directives:[{name:"db-click",rawName:"v-db-click"}],on:{click:function(t){return e.del(e.row,a.$index)}}},[e._v("删除")])]}}])})],1)],1),t("el-dialog",{attrs:{visible:e.optionsModal,title:"字典配置","close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.optionsModal=t},close:e.beforeChange}},[t("div",{staticClass:"options-list"},[t("el-form",{ref:"form",attrs:{inline:!0,"label-width":"80px"}},[t("div",{staticClass:"mb10"},[t("el-form-item",{attrs:{label:"字典名称："}},[t("el-input",{staticClass:"mr10",staticStyle:{width:"310px"},attrs:{placeholder:"字典名称"},model:{value:e.dictionaryName,callback:function(t){e.dictionaryName=t},expression:"dictionaryName"}})],1)],1),e._l(e.optionsList,(function(a,i){return t("div",{key:i,staticClass:"item"},[t("el-form-item",{attrs:{label:"数据名称："}},[t("el-input",{staticClass:"mr10",staticStyle:{width:"150px"},attrs:{placeholder:"label"},model:{value:a.label,callback:function(t){e.$set(a,"label",t)},expression:"item.label"}})],1),t("el-form-item",{attrs:{label:"数据值："}},[t("el-input",{staticClass:"mr10",staticStyle:{width:"150px"},attrs:{placeholder:"value"},model:{value:a.value,callback:function(t){e.$set(a,"value",t)},expression:"item.value"}})],1),t("div",{staticStyle:{display:"inline-block","margin-bottom":"14px"}},[i==e.optionsList.length-1?t("i",{directives:[{name:"db-click",rawName:"v-db-click"}],staticClass:"el-icon-circle-plus-outline add",attrs:{title:"新增"},on:{click:e.addOneOptions}}):e._e(),0<i?t("i",{directives:[{name:"db-click",rawName:"v-db-click"}],staticClass:"el-icon-remove-outline delete",attrs:{title:"删除"},on:{click:function(t){return e.delOneOptions(i)}}}):e._e()])],1)}))],2)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{directives:[{name:"db-click",rawName:"v-db-click"}],on:{click:function(t){e.optionsModal=!1}}},[e._v("取 消")]),t("el-button",{directives:[{name:"db-click",rawName:"v-db-click"}],attrs:{type:"primary"},on:{click:e.addOptions}},[e._v("确 定")])],1)])],1)}),[],!1,null,"0820acc2",null).exports),{name:"",props:{storage:{type:Object,default:function(){return{}}}},data:function(){return{storageRules:{}}},created:function(){},mounted:function(){},methods:{}}),m=(u=(a("49e4"),Object(o.a)(u,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"main"},[t("el-alert",{staticClass:"mb20",attrs:{closable:""},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("crud生成文件位置说明")]},proxy:!0}])},[[t("p",[e._v("1、生成的文件位置尽量不能修改，可以在创建后自行移动")]),t("p",[e._v("2、生成的文件位置不会包含文件的绝对路径，在创建时会携带提前预设的绝对路径")]),t("p",[e._v("3、前端模板文件默认位置在：config/app.php的admin_template_path中配置")]),t("p",[e._v("4、后端默认生成位置为：网站根目录")]),t("p",[e._v("5、确保前端/admin/src目录、后端app目录有写入创建文件权限")])]],2),t("el-form",{ref:"foundation",attrs:{model:e.storage,rules:e.storageRules,"label-width":"140px"}},[t("el-form-item",{attrs:{label:"生成controller位置："}},[t("el-input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.controller,callback:function(t){e.$set(e.storage,"controller",t)},expression:"storage.controller"}}),t("div",{staticClass:"tip"},[e._v("生成后端控制器文件存放位置")])],1),t("el-form-item",{attrs:{label:"生成service位置："}},[t("el-input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.service,callback:function(t){e.$set(e.storage,"service",t)},expression:"storage.service"}}),t("div",{staticClass:"tip"},[e._v("生成后端service文件存放位置")])],1),t("el-form-item",{attrs:{label:"生成dao位置："}},[t("el-input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.dao,callback:function(t){e.$set(e.storage,"dao",t)},expression:"storage.dao"}}),t("div",{staticClass:"tip"},[e._v("生成后端dao文件存放位置")])],1),t("el-form-item",{attrs:{label:"生成model位置："}},[t("el-input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.model,callback:function(t){e.$set(e.storage,"model",t)},expression:"storage.model"}}),t("div",{staticClass:"tip"},[e._v("生成后端model文件存放位置")])],1),t("el-form-item",{attrs:{label:"生成route位置："}},[t("el-input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.route,callback:function(t){e.$set(e.storage,"route",t)},expression:"storage.route"}}),t("div",{staticClass:"tip"},[e._v("生成后端路由存放位置")])],1),t("el-form-item",{attrs:{label:"生成validate位置："}},[t("el-input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.validate,callback:function(t){e.$set(e.storage,"validate",t)},expression:"storage.validate"}}),t("div",{staticClass:"tip"},[e._v("生成后端验证器存放位置")])],1),t("el-form-item",{attrs:{label:"生成pages位置："}},[t("el-input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.pages,callback:function(t){e.$set(e.storage,"pages",t)},expression:"storage.pages"}}),t("div",{staticClass:"tip"},[e._v("生成前端页面文件存放位置")])],1),t("el-form-item",{attrs:{label:"生成api位置："}},[t("el-input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.api,callback:function(t){e.$set(e.storage,"api",t)},expression:"storage.api"}}),t("div",{staticClass:"tip"},[e._v("生成前端api接口文件存放位置")])],1),t("el-form-item",{attrs:{label:"生成router位置："}},[t("el-input",{staticClass:"form-width",attrs:{disabled:"",placeholder:"请输入"},model:{value:e.storage.router,callback:function(t){e.$set(e.storage,"router",t)},expression:"storage.router"}}),t("div",{staticClass:"tip"},[e._v("生成前端路由存放位置")])],1)],1)],1)}),[],!1,null,"ff70746e",null).exports),a("46c47")),f=a("6987");a("f478"),s={name:"system_code_generation",components:{FoundationForm:s,StorageLoc:u,TableForm:c,steps:a("6ea4").a},data:function(){return{currentTab:0,headerList:["基础信息","字段配置","存放位置"],formItem:{foundation:{pid:"",tableName:"",modelName:"",isTable:1,menuName:""},tableForm:{},storage:{},field:{},formItem:{}},ruleValidate:{foundation:{}},tableField:[],rowList:[],reqloading:!1,isLoading:!1,id:""}},computed:{fixBottomWidth:function(){var e=this.$store.state.themeConfig.themeConfig,t=e.layout;e=e.isCollapse,t=["columns"].includes(t)?e?"85px":"265px":["classic"].includes(t)?e?"69px":"190px":["defaults","classic"].includes(t)?e?"64px":"180px":"0px";return t}},created:function(){this.$route.query.id&&(this.id=this.$route.query.id,this.getDetail(this.$route.query.id))},mounted:function(){},methods:{getDetail:function(e){var t=this;this.isLoading=!0,Object(l.e)(e).then((function(e){e=e.data.crudInfo.field;var a=(t.formItem.foundation.pid=Number(e.pid),t.formItem.foundation.tableName=e.tableName,t.formItem.foundation.modelName=e.modelName,t.formItem.foundation.menuName=e.menuName,t.$refs.TableForm.tableField=e.tableField,t.formItem.storage=e.filePath,0);e.tableField.map((function(e){"create_time"!==e.field&&"update_time"!==e.field||2==++a&&(t.$refs.TableForm.isCreate=!0),"delete_time"===e.field&&(t.$refs.TableForm.isDelete=!0)})),t.isLoading=!1})).catch((function(e){t.$message.warning(e.msg)}))},storageData:function(e){this.formItem.storage=e},beforeTab:function(){this.currentTab--},addRow:function(){var e=this,t=this.formItem.foundation;if(!t.tableName)return this.$message.warning("请先填写表名");t={menuName:t.menuName,tableName:t.tableName,fromField:[],columnField:[]},Object(l.g)(t).then((function(t){e.$refs.TableForm.tableField=t.data.tableField.length?t.data.tableField:[],e.formItem.storage=t.data.makePath,t.data.tableField.length||e.$refs.TableForm.tableField.push({field:"id",field_type:"int",default:"",comment:"自增ID",required:!1,is_table:!0,table_name:"ID",limit:"15",primaryKey:1,from_type:""}),e.currentTab++})).catch((function(t){e.$message.warning(t.msg)}))},nextTab:function(){var e,t=this;if(0==this.currentTab){if(!this.formItem.foundation.tableName)return this.$message.warning("请输入表名");if(!this.formItem.foundation.modelName)return this.$message.warning("请输入模块名");if(!this.formItem.foundation.isTable){if(!this.$refs.TableForm.tableField.length)return this.$message.warning("请先添加表数据");if(this.$refs.TableForm.tableField.length)for(var a=0;a<this.$refs.TableForm.tableField.length;a++){var n=this.$refs.TableForm.tableField[a];if(!(-1!==["addSoftDelete","addTimestamps"].indexOf(n.field_type)||n.field&&n.field_type&&n.comment))return this.$message.warning("请完善sql表数据")}}if(this.id)return this.currentTab++;this.addRow()}else 2==this.currentTab?this.reqloading||(e=Object(i.a)(Object(i.a)({},this.formItem.foundation),{},{filePath:this.formItem.storage,tableField:this.$refs.TableForm.tableField,deleteField:this.id?this.$refs.TableForm.deleteField:[]}),(this.id?(e.id=this.id,this.$msgbox({title:"生成提醒",message:"重新提交会重新生成文件,删除、新增、修改的字段将直接从改表中进行修改,请慎重操作！！",showCancelButton:!0,cancelButtonText:"取消",confirmButtonText:"确定",iconClass:"el-icon-warning",confirmButtonClass:"btn-custom-cancel"})):this.$msgbox({title:"生成提醒",message:"生成后本地开发调试会直接加载生成的vue页面；如果是上线后进行生成,可以进行浏览，代码生成列表中的修改文件将不生效。需要重新打包上线！",showCancelButton:!0,cancelButtonText:"取消",confirmButtonText:"确定",iconClass:"el-icon-warning",confirmButtonClass:"btn-custom-cancel"})).then((function(){t.saveCodeCrud(e,!0)})).catch((function(){}))):this.currentTab<3&&this.currentTab++},saveCodeCrud:function(e,t){var a=this;this.reqloading=!0,Object(n.i)(e).then((function(e){a.$message.success(e.msg),a.getMenusUnique(),a.reqloading=!1,a.$router.push({name:"system_code_generation_list"})})).catch((function(e){a.reqloading=!1,a.$message.error(e.msg)}))},getMenusUnique:function(){var e=this;Object(m.c)().then((function(t){t=t.data;var a=(e.$store.commit("userInfo/uniqueAuth",t.uniqueAuth),e.$store.commit("menus/getmenusNav",t.menus),e.$store.dispatch("routesList/setRoutesList",t.menus),Object(f.c)(e.$router.options.routes));e.formatTwoStageRoutes(a),a=Object(f.c)(t.menus);e.$store.commit("menus/setOneLvRoute",a),e.bus.$emit("routesListChange")}))},formatTwoStageRoutes:function(e){var t,a,n=this;return!(e.length<=0)&&(t=[],a=[],e.forEach((function(e){e&&e.meta&&e.meta.keepAlive&&(t.push(Object(i.a)({},e)),a.push(e.name),n.$store.dispatch("keepAliveNames/setCacheKeepAlive",a))})),t)}}},a("39d1d"),u=Object(o.a)(s,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"code-wapper"},[t("pages-header",{ref:"pageHeader",attrs:{title:e.$route.meta.title,backUrl:e.$routeProStr+"/system/code_generation_list"}}),t("div",{staticClass:"message mt10"},[t("el-card",{attrs:{bordered:!1,shadow:"never"}},[t("steps",{attrs:{stepList:e.headerList,isActive:e.currentTab}})],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"0"==e.currentTab,expression:"currentTab == '0'"},{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"pt10 tab-1"},[t("el-card",{staticClass:"ivu-mt",attrs:{bordered:!1,shadow:"never"}},[t("FoundationForm",{ref:"Foundation",attrs:{foundation:e.formItem.foundation,tableField:e.tableField},on:{storageData:e.storageData}})],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"1"==e.currentTab,expression:"currentTab == '1'"}],staticClass:"pt10"},[t("el-card",{staticClass:"ivu-mt",attrs:{bordered:!1,shadow:"never"}},[t("TableForm",{ref:"TableForm",attrs:{foundation:e.formItem.foundation,tableField:e.tableField,id:e.id},on:{storageData:e.storageData}})],1)],1),t("div",{directives:[{name:"show",rawName:"v-show",value:"2"==e.currentTab,expression:"currentTab == '2'"}],staticClass:"pt10"},[t("el-card",{staticClass:"ivu-mt",attrs:{bordered:!1,shadow:"never"}},[t("StorageLoc",{attrs:{storage:e.formItem.storage}})],1)],1),t("el-card",{staticClass:"fixed-card",style:{left:"".concat(e.fixBottomWidth)},attrs:{bordered:!1,shadow:"never"}},[t("el-button",{directives:[{name:"db-click",rawName:"v-db-click"}],staticClass:"mr20",attrs:{disabled:!e.currentTab},on:{click:e.beforeTab}},[e._v("上一步")]),t("el-button",{directives:[{name:"db-click",rawName:"v-db-click"}],attrs:{type:"primary"},on:{click:e.nextTab}},[e._v(e._s(2==e.currentTab?"提交":"下一步"))])],1)],1)}),[],!1,null,"31849c70",null);t.default=u.exports},cb90:function(e,t,a){},eebf:function(e,t,a){a("cb90")},fa0a:function(e,t,a){}}]);