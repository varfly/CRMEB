(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-08621198"],{3353:function(e,t,a){a.r(t),a("caad"),a("b0c0");var r=a("c7eb"),n=a("1da1"),i=a("5530"),o=(a("a15b"),a("2f62")),s=a("f8b7"),d=a("a716"),l=a("31b4"),c=a("fc48"),u=a("61f8"),m=a("1031");l={components:{editFrom:l.a,detailsFrom:c.a,orderRemark:u.a,userDetails:d.a},data:function(){return{grid:{xl:7,lg:8,md:12,sm:24,xs:24},tbody:[],num:[],orderDatalist:null,loading:!1,FromData:null,total:0,orderId:0,animal:1,pagination:{page:1,limit:15,order_id:"",time:"",refund_type:0},timeVal:[],modal:!1,qrcode:null,name:"",spin:!1,pickerOptions:m.a}},computed:Object(i.a)(Object(i.a)({},Object(o.d)("order",["orderChartType"])),{},{labelWidth:function(){return this.isMobile?void 0:"80px"},labelPosition:function(){return this.isMobile?"top":"right"}}),created:function(){this.getOrderList()},methods:{onchangeCode:function(e){this.animal=e,this.qrcodeShow()},onchangeTime:function(e){this.pagination.page=1,this.timeVal=e||[],this.pagination.time=this.timeVal[0]&&this.timeVal?this.timeVal.join("-"):"",this.getOrderList()},userDetail:function(e){this.$refs.userDetails.modals=!0,this.$refs.userDetails.getDetails(e.uid)},changeMenu:function(e,t){var a=this;switch(this.orderId=e.id,t){case"1":this.delfromData={title:"修改立即支付",url:"/order/pay_offline/".concat(e.id),method:"post",ids:""},this.$modalSure(this.delfromData).then((function(e){a.$message.success(e.msg),a.getOrderList()})).catch((function(e){a.$message.error(e.msg)}));break;case"2":this.getData(e.order_id,2);break;case"3":this.getData(e.store_order_id,3);break;case"4":this.$refs.remarks.modals=!0,this.$refs.remarks.formValidate.remark=e.remark;break;case"5":this.getRefundData(e.id,e.refund_type);break;case"6":this.getRefundIntegral(e.id);break;case"7":this.getNoRefundData(e.id);break;case"8":this.delfromData={title:"删除订单",url:"/order/del/".concat(e.store_order_id),method:"DELETE",ids:""},this.delOrder(e,this.delfromData);break;case"10":this.delfromData={title:"立即打印订单",info:"您确认打印此订单吗?",url:"/order/print/".concat(e.id),method:"get",ids:""},this.$modalSure(this.delfromData).then((function(e){a.$message.success(e.msg),a.$emit("changeGetTabs"),a.getOrderList()})).catch((function(e){a.$message.error(e.msg)}));break;case"11":this.delfromData={title:"立即打印电子面单",info:"您确认打印此电子面单吗?",url:"/order/order_dump/".concat(e.id),method:"get",ids:""},this.$modalSure(this.delfromData).then((function(e){a.$message.success(e.msg),a.getOrderList()})).catch((function(e){a.$message.error(e.msg)}));break;default:this.delfromData={title:"删除订单",url:"/order/del/".concat(e.id),method:"DELETE",ids:""},this.delOrder(e,this.delfromData)}},getRefundData:function(e,t){var a=this;2==t?(this.delfromData={title:"同意退货退款",url:"/refund/agree/".concat(e),method:"get"},this.$modalSure(this.delfromData).then((function(e){a.$message.success(e.msg),a.getOrderList()})).catch((function(e){a.$message.error(e.msg)}))):this.$modalForm(Object(s.l)(e)).then((function(){a.getOrderList(),a.$emit("changeGetTabs")}))},getRefundIntegral:function(e){var t=this;Object(s.W)(e).then(function(){var e=Object(n.a)(Object(r.a)().mark((function e(a){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.FromData=a.data,t.$refs.edits.modals=!0;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.$message.error(e.msg)}))},getData:function(e,t){var a=this;t=2==t?s.h:s.g;t(e).then(function(){var e=Object(n.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.orderDatalist=t.data,a.$nextTick((function(e){a.$refs.detailss.modals=!0}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){a.$message.error(e.msg)}))},delOrder:function(e,t){var a=this;1===e.is_del?this.$modalSure(t).then((function(e){a.$message.success(e.msg),a.getOrderList()})).catch((function(e){a.$message.error(e.msg)})):this.$message.error("您选择的的订单存在用户未删除的订单，无法删除用户未删除的订单！")},submitFail:function(){this.getOrderList()},selectChange2:function(e){this.pagination.page=1,this.getOrderList(e)},getNoRefundData:function(e){var t=this;this.$modalForm(Object(s.m)(e)).then((function(){t.getOrderList(),t.$emit("changeGetTabs")}))},getOrderList:function(){var e=this;this.loading=!0,Object(s.K)(this.pagination).then((function(t){e.loading=!1;t=t.data;var a=t.count,r=t.list;t=t.num;e.total=a,e.tbody=r,e.num=t})).catch((function(t){e.loading=!1,e.$message.error(t.msg)}))},nameSearch:function(){this.pagination.page=1,this.getOrderList()},orderSearch:function(){this.pagination.page=1,this.getOrderList()},delivery:function(e){var t=this;Object(s.i)(e.id).then(function(){var e=Object(n.a)(Object(r.a)().mark((function e(a){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.FromData=a.data,t.$refs.edits.modals=!0;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.$message.error(e.msg)}))}}},a("94e2"),c=a("2877"),u=Object(c.a)(l,(function(){var e=this,t=e._self._c;return t("div",[t("el-card",{staticClass:"ivu-mt",attrs:{bordered:!1,shadow:"never","body-style":{padding:0}}},[t("div",{staticClass:"padding-add"},[t("el-form",{ref:"pagination",attrs:{model:e.pagination,"label-width":e.labelWidth,"label-position":e.labelPosition,inline:""},nativeOn:{submit:function(e){e.preventDefault()}}},[t("el-form-item",{attrs:{label:"退款状态："}},[t("el-select",{staticClass:"form_content_width",attrs:{clearable:"",placeholder:"全部"},on:{change:e.selectChange2},model:{value:e.pagination.refund_type,callback:function(t){e.$set(e.pagination,"refund_type",t)},expression:"pagination.refund_type"}},e._l(e.num,(function(a,r){return t("el-option",{key:r,attrs:{value:r,label:a.name}},[e._v(e._s(a.name))])})),1)],1),t("el-form-item",{attrs:{label:"退款时间："}},[t("el-date-picker",{staticClass:"mr20",staticStyle:{width:"250px"},attrs:{clearable:"",type:"daterange",editable:!1,format:"yyyy/MM/dd","value-format":"yyyy/MM/dd","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},on:{change:e.onchangeTime},model:{value:e.timeVal,callback:function(t){e.timeVal=t},expression:"timeVal"}})],1),t("el-form-item",{attrs:{label:"订单号：","label-for":"title"}},[t("el-input",{staticClass:"form_content_width",attrs:{clearable:"",placeholder:"请输入订单号"},model:{value:e.pagination.order_id,callback:function(t){e.$set(e.pagination,"order_id",t)},expression:"pagination.order_id"}})],1),t("el-form-item",[t("el-button",{directives:[{name:"db-click",rawName:"v-db-click"}],attrs:{type:"primary"},on:{click:e.orderSearch}},[e._v("查询")])],1)],1)],1)]),t("el-card",{staticClass:"ivu-mt mt16",attrs:{bordered:!1,shadow:"never"}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"table",attrs:{data:e.tbody,"highlight-current-row":"","no-userFrom-text":"暂无数据","no-filtered-userFrom-text":"暂无筛选结果"}},[t("el-table-column",{attrs:{label:"退款订单号","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"cup hover-pimary",staticStyle:{display:"block"},domProps:{textContent:e._s(a.row.order_id)},on:{click:function(t){return e.changeMenu(a.row,"2")}}}),1===a.row.is_del?t("span",{staticStyle:{color:"#ed4014",display:"block"}},[e._v("用户已删除")]):e._e()]}}])}),t("el-table-column",{attrs:{label:"原订单号","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"cup hover-pimary",staticStyle:{display:"block"},domProps:{textContent:e._s(a.row.store_order_order_id)},on:{click:function(t){return e.changeMenu(a.row,"3")}}})]}}])}),t("el-table-column",{attrs:{label:"商品信息","min-width":"250"},scopedSlots:e._u([{key:"default",fn:function(a){return e._l(a.row._info,(function(a,r){return t("div",{key:r,staticClass:"tab"},[t("img",{directives:[{name:"lazy",rawName:"v-lazy",value:(a.cart_info.productInfo.attrInfo||a.cart_info.productInfo).image,expression:"\n                item.cart_info.productInfo.attrInfo\n                  ? item.cart_info.productInfo.attrInfo.image\n                  : item.cart_info.productInfo.image\n              "}]}),t("el-tooltip",{attrs:{placement:"top","open-delay":300}},[t("div",{attrs:{slot:"content"},slot:"content"},[t("div",[t("span",[e._v("商品名称：")]),t("span",[e._v(e._s(a.cart_info.productInfo.store_name||"--"))])]),t("div",[t("span",[e._v("规格名称：")]),t("span",[e._v(e._s(a.cart_info.productInfo.attrInfo?a.cart_info.productInfo.attrInfo.suk:"---"))])]),t("div",[t("span",[e._v("价格：")]),t("span",[e._v("¥"+e._s(a.cart_info.truePrice||"--"))])]),t("div",[t("span",[e._v("数量：")]),t("span",[e._v(e._s(a.cart_info.cart_num||"--"))])])]),t("span",{staticClass:"line2 w-250"},[e._v(e._s(a.cart_info.productInfo.store_name))])])],1)}))}}])}),t("el-table-column",{attrs:{label:"用户信息","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"cup hover-pimary",on:{click:function(t){return e.userDetail(a.row,"2")}}},[e._v(e._s(a.row.nickname))])]}}])}),t("el-table-column",{attrs:{label:"实际支付","min-width":"70"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.pay_price))])]}}])}),t("el-table-column",{attrs:{label:"发起退款时间","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.add_time))])]}}])}),t("el-table-column",{attrs:{label:"退款状态","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[1==a.row.refund_type?t("div",[e._v("仅退款")]):2==a.row.refund_type?t("div",[e._v("退货退款")]):3==a.row.refund_type?t("div",[t("div",[e._v("拒绝退款")]),t("div",{staticClass:"c-red"},[e._v("原因："+e._s(a.row.refuse_reason))])]):4==a.row.refund_type?t("div",[e._v("商品待退货")]):5==a.row.refund_type?t("div",[t("div",[e._v("退货待收货")]),t("div",[e._v("单号："+e._s(a.row.refund_express))])]):6==a.row.refund_type?t("div",[e._v("已退款")]):e._e()]}}])}),t("el-table-column",{attrs:{label:"订单状态","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(a.row.store_order_status))])]}}])}),t("el-table-column",{attrs:{label:"退款信息","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"pt5",domProps:{innerHTML:e._s(a.row.refund_reason)}}),a.row.refund_img.length?t("div",{staticClass:"pictrue-box"},e._l(a.row.refund_img||[],(function(e,a){return t("div",{directives:[{name:"viewer",rawName:"v-viewer"}],key:a},[t("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e,expression:"item"}],staticClass:"pictrue mr10",attrs:{src:e}})])})),0):e._e()]}}])}),t("el-table-column",{attrs:{fixed:"right",label:"操作",width:"80"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-dropdown",{attrs:{size:"small"},on:{command:function(t){return e.changeMenu(a.row,t)}}},[t("span",{staticClass:"el-dropdown-link"},[e._v("更多"),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:1===a.row._status&&0===a.row.paid&&"offline"===a.row.pay_type,expression:"scope.row._status === 1 && scope.row.paid === 0 && scope.row.pay_type === 'offline'"}],ref:"ones",attrs:{command:"1"}},[e._v("立即支付")]),t("el-dropdown-item",{attrs:{command:"2"}},[e._v("订单详情")]),t("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:1!==a.row._status||3===a.row._status&&0<a.row.use_integral&&a.row.use_integral>=a.row.back_integral,expression:"\n                  scope.row._status !== 1 ||\n                  (scope.row._status === 3 &&\n                    scope.row.use_integral > 0 &&\n                    scope.row.use_integral >= scope.row.back_integral)\n                "}],attrs:{command:"4"}},[e._v("售后备注")]),t("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:[1,2,5].includes(a.row.refund_type)&&(parseFloat(a.row.pay_price)>parseFloat(a.row.refunded_price)||0==a.row.pay_price),expression:"\n                  [1, 2, 5].includes(scope.row.refund_type) &&\n                  (parseFloat(scope.row.pay_price) > parseFloat(scope.row.refunded_price) || scope.row.pay_price == 0)\n                "}],attrs:{command:"5"}},[e._v(e._s(2==a.row.refund_type?"同意退货":"立即退款"))]),t("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:[1,2].includes(a.row.refund_type)&&0===a.row.is_pink_cancel,expression:"[1, 2].includes(scope.row.refund_type) && scope.row.is_pink_cancel === 0"}],attrs:{command:"7"}},[e._v("不退款")]),t("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:1==a.row.is_del,expression:"scope.row.is_del == 1"}],attrs:{command:"8"}},[e._v("删除订单")])],1)],1)]}}])})],1),t("div",{staticClass:"acea-row row-right page"},[e.total?t("pagination",{attrs:{total:e.total,page:e.pagination.page,limit:e.pagination.limit},on:{"update:page":function(t){return e.$set(e.pagination,"page",t)},"update:limit":function(t){return e.$set(e.pagination,"limit",t)},pagination:e.getOrderList}}):e._e()],1)],1),t("edit-from",{ref:"edits",attrs:{FromData:e.FromData},on:{submitFail:e.submitFail}}),t("user-details",{ref:"userDetails"}),t("details-from",{ref:"detailss",attrs:{orderDatalist:e.orderDatalist,orderId:e.orderId,is_refund:1}}),t("order-remark",{ref:"remarks",attrs:{remarkType:"refund",orderId:e.orderId},on:{submitFail:e.submitFail}})],1)}),[],!1,null,"13fb55eb",null);t.default=u.exports},"662c":function(e,t,a){},"94e2":function(e,t,a){a("662c")}}]);