(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-28987d5a"],{6729:function(t,e,a){a("72da")},"72da":function(t,e,a){},d99c:function(t,e,a){a.r(e),a("b0c0");var i=a("c7eb"),n=a("1da1"),r=a("5530"),s=(a("c740"),a("d81d"),a("14d9"),a("a434"),a("d3b7"),a("159b"),a("2f62")),o=a("90e7");a("c276"),r={name:"marketing_channel_code",filters:{typeFilter:function(t){return{wechat:"微信用户",routine:"小程序用户"}[t]}},computed:Object(r.a)(Object(r.a)({},Object(s.d)("media",["isMobile"])),{},{labelWidth:function(){return this.isMobile?void 0:"80px"},labelPosition:function(){return this.isMobile?"top":"right"}}),data:function(){return{treeId:"",isChat:!0,formValidate3:{page:1,limit:15},total3:0,loading3:!1,modals3:!1,tabList:[],formValidate5:{page:1,limit:15,uid:0,to_uid:0,id:0},tableList5:[],FromData:null,formValidate:{page:1,limit:15,data:"",type:"",nickname:""},tableList2:[],modals:!1,total:0,tableFrom:{page:1,limit:15,cate_id:0,name:""},userData:{id:0,page:1,limit:15},timeVal:[],loading:!1,tableList:[],loading2:!1,total2:0,addFrom:{uids:[]},selections:[],rows:{},rowRecord:{},theme3:"light",labelSort:[],sortName:"",current:0,uid:0}},activated:function(){this.getUserLabelAll()},mounted:function(){},methods:{changeMenu:function(t,e){switch(this.orderId=t.id,e){case"1":this.downLoadCode(t.image);break;case"2":this.$router.push({path:this.$routeProStr+"/marketing/channel_code/code_statistic?id="+t.id});break;case"3":this.modals=!0,this.userData.id=t.id,this.getUserList(),this.break}},downLoadCode:function(t){if(!t)return this.$message.warning("暂无二维码");var e=new Image;e.src=t,e.setAttribute("crossOrigin","anonymous"),e.onload=function(){var t=document.createElement("canvas");t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0,e.width,e.height);t=t.toDataURL();var a=document.createElement("a"),i=new MouseEvent("click");a.download=name||"photo",a.href=t,a.dispatchEvent(i)}},getUserList:function(){var t=this;Object(o.v)(this.userData).then(function(){var e=Object(n.a)(Object(i.a)().mark((function e(a){var n,r;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.data,r=[],n.list.map((function(t){r.push(t.user)})),t.tabList=r,t.total2=n.count,t.loading2=!1;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.loading=!1,t.tabList=[],t.$message.error(e.msg)}))},getUserLabelAll:function(t){var e=this;Object(o.lc)().then((function(a){a=a.data.data,a.unshift({cate_name:"全部",id:""}),a.forEach((function(t){t.status=!1})),t||(e.sortName=a[0].id,e.tableFrom.cate_id=a[0].id,e.getList()),e.labelSort=a}))},addSort:function(){var t=this;this.$modalForm(Object(o.gc)(0)).then((function(){return t.getUserLabelAll()}))},labelEdit:function(t){var e=this;this.$modalForm(Object(o.gc)(t.id)).then((function(){return e.getUserLabelAll(1)}))},deleteSort:function(t,e){var a=this,i=this.labelSort.findIndex((function(e){return e.id==t.id}));e={title:e,num:i,url:"app/wechat_qrcode/cate/del/".concat(t.id),method:"DELETE",ids:""};this.$modalSure(e).then((function(t){a.$message.success(t.msg),a.labelSort.splice(i,1),a.labelSort=[],a.getUserLabelAll()})).catch((function(t){a.$message.error(t.msg)}))},showMenu:function(t){this.labelSort.forEach((function(e){e.id==t.id?e.status=!t.status:e.status=!1}))},bindMenuItem:function(t,e){this.tableFrom.page=1,this.current=e,this.labelSort.forEach((function(t){t.status=!1})),this.tableFrom.cate_id=t.id,this.getList()},cancel:function(){this.formValidate={page:1,limit:10,data:"",type:"",nickname:""}},edit:function(t){this.$router.push({path:this.$routeProStr+"/marketing/channel_code/create?id="+t.id})},add:function(){this.$router.push({path:this.$routeProStr+"/marketing/channel_code/create"})},getListService:function(){var t=this;this.loading2=!0,kefucreateApi(this.formValidate).then(function(){var e=Object(n.a)(Object(i.a)().mark((function e(a){var n;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.data,t.tableList2=n.list,t.total2=n.count,t.tableList2.map((function(t){t._isChecked=!1})),t.loading2=!1;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.loading2=!1,t.$message.error(e.msg)}))},userSearchs:function(){this.formValidate.page=1,this.getList()},del:function(t,e,a){var i=this;e={title:e,num:a,url:"/app/wechat_qrcode/del/".concat(t.id),method:"DELETE",ids:""};this.$modalSure(e).then((function(t){i.$message.success(t.msg),i.tableList.splice(a,1)})).catch((function(t){i.$message.error(t.msg)}))},getList:function(){var t=this;this.loading=!0,Object(o.ic)(this.tableFrom).then(function(){var e=Object(n.a)(Object(i.a)().mark((function e(a){var n;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.data,t.tableList=n.list,t.total=a.data.count,t.loading=!1;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.loading=!1,t.$message.error(e.msg)}))},onchangeIsShow:function(t){var e=this;t={id:t.id,status:t.status};Object(o.kc)(t).then(function(){var t=Object(n.a)(Object(i.a)().mark((function t(a){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.$message.success(a.msg);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$message.error(t.msg)}))},clickMenu:function(t,e){1==e?this.labelEdit(t):2==e&&this.deleteSort(t,"删除分类")}}},a("6729"),s=a("2877"),s=Object(s.a)(r,(function(){var t=this,e=t._self._c;return e("div",[e("el-row",{ref:"warpper",staticClass:"ivu-mt box-wrapper"},[e("el-col",{staticClass:"left-wrapper",attrs:{span:4}},[e("div",{directives:[{name:"db-click",rawName:"v-db-click"}],staticClass:"tree_tit",on:{click:t.addSort}},[e("i",{staticClass:"el-icon-circle-plus"}),t._v("\n        添加分组\n      ")]),e("div",{staticClass:"tree"},[e("el-tree",{attrs:{data:t.labelSort,"node-key":"id","default-expand-all":"","highlight-current":"","expand-on-click-node":!1,"current-node-key":t.treeId},on:{"node-click":t.bindMenuItem},scopedSlots:t._u([{key:"default",fn:function(i){var n=i.data;return e("span",{staticClass:"custom-tree-node"},[e("div",{staticClass:"file-name"},[n.pid?t._e():e("img",{staticClass:"icon",attrs:{src:a("c583")}}),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:n.cate_name,placement:"top"}},[e("div",{staticClass:"text line1"},[t._v("\n                  "+t._s(n.cate_name)+"\n                ")])])],1),n.id?e("span",[e("el-dropdown",{on:{command:function(e){return t.clickMenu(n,e)}}},[e("i",{staticClass:"el-icon-more el-icon--right"}),e("template",{slot:"dropdown"},[e("el-dropdown-menu",[e("el-dropdown-item",{attrs:{command:"1"}},[t._v("编辑分组")]),n.id?e("el-dropdown-item",{attrs:{command:"2"}},[t._v("删除分组")]):t._e()],1)],1)],2)],1):t._e()])}}])})],1)]),e("el-col",{ref:"rightBox",attrs:{span:20}},[e("el-card",{staticClass:"left-radius-none",attrs:{bordered:!1,shadow:"never"}},[e("el-row",{staticClass:"mb14"},[e("el-col",{attrs:{span:18}},[e("el-button",{directives:[{name:"auth",rawName:"v-auth",value:["marketing-channel_code-create"],expression:"['marketing-channel_code-create']"},{name:"db-click",rawName:"v-db-click"}],attrs:{type:"primary"},on:{click:t.add}},[t._v("新建渠道码")])],1),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"flex"},[e("el-input",{staticClass:"mr10",attrs:{search:"",placeholder:"请输入渠道码名称"},model:{value:t.tableFrom.name,callback:function(e){t.$set(t.tableFrom,"name",e)},expression:"tableFrom.name"}}),e("el-button",{directives:[{name:"db-click",rawName:"v-db-click"}],attrs:{type:"primary"},on:{click:t.userSearchs}},[t._v("搜索")])],1)])],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.tableList,"highlight-current-row":"","no-userFrom-text":"暂无数据","no-filtered-userFrom-text":"暂无筛选结果"}},[e("el-table-column",{attrs:{label:"渠道码",width:"80"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"tabBox_img"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.row.image,expression:"scope.row.image"}]})])]}}])}),e("el-table-column",{attrs:{label:"渠道码名称","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.name))])]}}])}),e("el-table-column",{attrs:{label:"总关注数","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.follow))])]}}])}),e("el-table-column",{attrs:{label:"昨日新增关注","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.y_follow))])]}}])}),e("el-table-column",{attrs:{label:"用户标签","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(a){return t._l(a.row.label_name,(function(a,i){return e("el-tag",{key:i,staticClass:"label-name"},[t._v(t._s(a))])}))}}])}),e("el-table-column",{attrs:{label:"时间","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[0===a.row.stop?e("span",[t._v(" 永久 ")]):t._e(),1===a.row.stop?e("span",[e("div",[t._v(t._s(a.row.add_time))]),e("div",[t._v("-")]),e("div",[t._v(t._s(a.row.end_time))])]):t._e(),-1===a.row.stop?e("span",[t._v("已过期")]):t._e()]}}])}),e("el-table-column",{attrs:{label:"关联推广员","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"tabBox_img"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.row.avatar,expression:"scope.row.avatar"}]})])]}}])}),e("el-table-column",{attrs:{label:"状态","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-switch",{staticClass:"defineSwitch",attrs:{"active-value":1,"inactive-value":0,value:a.row.status,disabled:2==a.row.lottery_status,size:"large","active-text":"开启","inactive-text":"关闭"},on:{change:function(e){return t.onchangeIsShow(a.row)}},model:{value:a.row.status,callback:function(e){t.$set(a.row,"status",e)},expression:"scope.row.status"}})]}}])}),e("el-table-column",{attrs:{label:"操作",fixed:"right",width:"170"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("a",{directives:[{name:"db-click",rawName:"v-db-click"}],on:{click:function(e){return t.edit(a.row)}}},[t._v("编辑")]),e("el-divider",{attrs:{direction:"vertical"}}),e("a",{directives:[{name:"db-click",rawName:"v-db-click"}],on:{click:function(e){return t.del(a.row,"删除二维码",a.$index)}}},[t._v("删除")]),e("el-divider",{attrs:{direction:"vertical"}}),e("el-dropdown",{attrs:{size:"small",transfer:!0},on:{command:function(e){return t.changeMenu(a.row,e)}}},[e("span",{staticClass:"el-dropdown-link"},[t._v("更多"),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"1"}},[t._v("下载")]),e("el-dropdown-item",{attrs:{command:"2"}},[t._v("统计")]),e("el-dropdown-item",{attrs:{command:"3"}},[t._v("用户列表")])],1)],1)]}}])})],1),e("div",{staticClass:"acea-row row-right page"},[t.total?e("pagination",{attrs:{total:t.total,page:t.tableFrom.page,limit:t.tableFrom.limit},on:{"update:page":function(e){return t.$set(t.tableFrom,"page",e)},"update:limit":function(e){return t.$set(t.tableFrom,"limit",e)},pagination:t.getList}}):t._e()],1)],1)],1)],1),e("el-dialog",{attrs:{visible:t.modals,title:"渠道码用户列表","close-on-click-modal":!1,width:"900px"},on:{"update:visible":function(e){t.modals=e}}},[e("el-table",{ref:"selection",attrs:{data:t.tabList,"empty-text":"暂无数据","highlight-current-row":"","max-height":"400"}},[e("el-table-column",{attrs:{label:"UID","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.uid))])]}}])}),e("el-table-column",{attrs:{label:"用户头像","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"tabBox_img"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.row.avatar,expression:"scope.row.avatar"}]})])]}}])}),e("el-table-column",{attrs:{label:"用户昵称","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.nickname))])]}}])})],1),e("div",{staticClass:"acea-row row-right page"},[t.total2?e("pagination",{attrs:{total:t.total2,page:t.userData.page,limit:t.userData.limit},on:{"update:page":function(e){return t.$set(t.userData,"page",e)},"update:limit":function(e){return t.$set(t.userData,"limit",e)},pagination:t.getUserList}}):t._e()],1)],1)],1)}),[],!1,null,"1c7b1a48",null);e.default=s.exports}}]);