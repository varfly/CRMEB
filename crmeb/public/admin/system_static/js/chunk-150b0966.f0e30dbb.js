(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-150b0966"],{"129f":function(t,e,a){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},1698:function(t,e,a){a.d(e,"h",(function(){return i})),a.d(e,"g",(function(){return s})),a.d(e,"f",(function(){return r})),a.d(e,"a",(function(){return o})),a.d(e,"i",(function(){return l})),a.d(e,"e",(function(){return c})),a.d(e,"d",(function(){return u})),a.d(e,"c",(function(){return d})),a.d(e,"b",(function(){return m}));var n=a("6b6c");function i(t){return Object(n.a)({url:"agent/level",method:"get",params:t})}function s(t,e){return Object(n.a)({url:e,method:"get",params:t})}function r(t,e){return Object(n.a)({url:e,method:"get",params:t})}function o(t){return Object(n.a)({url:"agent/get_task_num_form/".concat(t),method:"get"})}function l(t){return Object(n.a)({url:t,method:"PUT"})}function c(t){return Object(n.a)({url:t,method:"PUT"})}function u(t){return Object(n.a)({url:"agent/level_task",method:"get",params:t})}function d(t,e){return Object(n.a)({url:e,method:"get",params:t})}function m(t,e){return Object(n.a)({url:e,method:"get",params:t})}},"30cc":function(t,e,a){a.r(e),a("4e82"),a("b0c0"),a("ac1f"),a("841c");var n=a("c7eb"),i=a("1da1"),s=a("5530"),r=(a("99af"),a("a434"),a("2f62")),o=a("1698");s={name:"list",data:function(){return{grid:{xl:7,lg:7,md:12,sm:24,xs:24},modal1:!1,modal2:!1,formValidate:{status:"",page:1,limit:20,gid:0},taskData:{keyword:"",page:1,limit:20,status:""},total:0,taskTotal:0,tabList:[],taskTabList:[],columns1:[{key:"id",minWidth:35,title:"ID"},{slot:"image",minWidth:35,title:"背景图"},{key:"name",minWidth:35,title:"名称"},{key:"grade",minWidth:35,title:"等级"},{slot:"one_brokerage",minWidth:35,title:"一级上浮比例"},{slot:"one_brokerage_ratio",minWidth:35,title:"一级分佣比例(上浮后)"},{slot:"two_brokerage",minWidth:35,title:"二级上浮比例"},{slot:"two_brokerage_ratio",minWidth:35,title:"二级分佣比例(上浮后)"},{slot:"status",minWidth:35,title:"是否显示"},{minWidth:120,slot:"action",title:"操作"}],columns2:[{key:"id",minWidth:35,title:"ID"},{key:"name",minWidth:35,title:"名称"},{key:"type_name",minWidth:35,title:"任务类型"},{key:"number",minWidth:35,title:"限定数量"},{slot:"status",minWidth:35,title:"是否显示"},{key:"sort",minWidth:35,title:"排序"},{fixed:"right",minWidth:120,slot:"action",title:"操作"}],FromData:null,loading:!1,taskLoading:!1,titleType:"group",groupAll:[],theme3:"light",labelSort:[],sortName:null,current:0,model1:"",value1:""}},computed:Object(s.a)(Object(s.a)({},Object(r.d)("admin/layout",["isMobile"])),{},{labelWidth:function(){return this.isMobile?void 0:"80px"},labelPosition:function(){return this.isMobile?"top":"right"}}),watch:{$route:function(t,e){this.$route.params.id}},mounted:function(){this.getList()},methods:{bindMenuItem:function(t,e){this.current=e,this.formValidate.gid=t.id,this.getListHeader(),this.getList()},getList:function(){var t=this;this.loading=!0,Object(o.h)(this.formValidate).then(function(){var e=Object(i.a)(Object(n.a)().mark((function e(a){var i;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=a.data,t.tabList=i.list,t.total=i.count,t.loading=!1;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.loading=!1,t.$message.error(e.msg)}))},getTaskList:function(){var t=this;this.taskLoading=!0,Object(o.d)(this.taskData).then(function(){var e=Object(i.a)(Object(n.a)().mark((function e(a){var i;return Object(n.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=a.data,t.taskTabList=i.list,t.taskTotal=i.count,t.taskLoading=!1;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.taskLoading=!1,t.$message.error(e.msg)}))},search:function(){this.formValidate.page=1,this.getList()},searchTask:function(){this.taskData.page=1,this.getTaskList()},taskEdit:function(){var t=this;this.$modalForm(Object(o.a)(this.id)).then((function(){return t.getList()}))},groupAdd:function(){var t=this;this.$modalForm(Object(o.f)({},"/agent/level/create")).then((function(){return t.getList()}))},taskAdd:function(){var t=this;this.$modalForm(Object(o.b)({},"/agent/level_task/create?level_id="+this.taskData.id)).then((function(){return t.getTaskList()}))},onchangeIsShow:function(t){var e=this;Object(o.i)("agent/level/set_status/".concat(t.id,"/").concat(t.status)).then(function(){var t=Object(i.a)(Object(n.a)().mark((function t(a){return Object(n.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.$message.success(a.msg),e.getList();case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$message.error(t.msg)}))},onchangeTaskIsShow:function(t){var e=this;Object(o.e)("agent/level_task/set_status/".concat(t.id,"/").concat(t.status)).then(function(){var t=Object(i.a)(Object(n.a)().mark((function t(a){return Object(n.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.$message.success(a.msg),e.getTaskList();case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){e.$message.error(t.msg)}))},addTask:function(t){this.id=t.id,this.modal2=!0,this.taskData.id=t.id,this.getTaskList()},edit:function(t){var e=this,a={gid:t.gid};this.$modalForm(Object(o.g)(a,"agent/level/".concat(t.id,"/edit"))).then((function(){return e.getList()}))},editTask:function(t){var e=this,a={gid:t.gid};this.$modalForm(Object(o.c)(a,"agent/level_task/".concat(t.id,"/edit"))).then((function(){return e.getTaskList()}))},del:function(t,e,a){var n=this;e={title:e,num:a,url:"agent/level/".concat(t.id),method:"DELETE",ids:""};this.$modalSure(e).then((function(t){n.$message.success(t.msg),n.tabList.splice(a,1)})).catch((function(t){n.$message.error(t.msg)}))},delTask:function(t,e,a){var n=this;e={title:e,num:a,url:"agent/level_task/".concat(t.id),method:"DELETE",ids:""};this.$modalSure(e).then((function(t){n.$message.success(t.msg),n.taskTabList.splice(a,1)})).catch((function(t){n.$message.error(t.msg)}))}}},a("b204"),r=a("2877"),a=Object(r.a)(s,(function(){var t=this,e=t._self._c;return e("div",[e("el-card",{staticClass:"ivu-mb-16",attrs:{bordered:!1,shadow:"never","body-style":{padding:0}}},[e("div",{staticClass:"padding-add"},[e("el-form",{ref:"formValidate",attrs:{model:t.formValidate,"label-width":t.labelWidth,"label-position":t.labelPosition,inline:""},nativeOn:{submit:function(t){t.preventDefault()}}},[e("el-form-item",{attrs:{label:"是否显示："}},[e("el-select",{staticClass:"form_content_width",attrs:{clearable:""},on:{change:t.search},model:{value:t.formValidate.status,callback:function(e){t.$set(t.formValidate,"status",e)},expression:"formValidate.status"}},[e("el-option",{attrs:{value:"",label:"全部"}}),e("el-option",{attrs:{value:1,label:"显示"}}),e("el-option",{attrs:{value:0,label:"不显示"}})],1)],1),e("el-form-item",{attrs:{label:"等级名称："}},[e("el-input",{staticClass:"form_content_width",attrs:{clearable:"",placeholder:"请输入等级名称"},model:{value:t.formValidate.keyword,callback:function(e){t.$set(t.formValidate,"keyword",e)},expression:"formValidate.keyword"}})],1),e("el-form-item",[e("el-button",{directives:[{name:"db-click",rawName:"v-db-click"}],attrs:{type:"primary"},on:{click:t.search}},[t._v("查询")])],1)],1)],1)]),e("el-card",{staticClass:"ivu-mt mt16",attrs:{bordered:!1,shadow:"never"}},[e("el-button",{directives:[{name:"db-click",rawName:"v-db-click"}],attrs:{type:"primary"},on:{click:t.groupAdd}},[t._v("添加等级")]),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",staticClass:"mt14",attrs:{data:t.tabList,"highlight-current-row":"","no-userFrom-text":"暂无数据","no-filtered-userFrom-text":"暂无筛选结果"}},[e("el-table-column",{attrs:{label:"ID",width:"50"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.id))])]}}])}),e("el-table-column",{attrs:{label:"商品图片","min-width":"90"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"tabBox_img"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.row.image,expression:"scope.row.image"}]})])]}}])}),e("el-table-column",{attrs:{label:"名称","min-width":"130"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.name))])]}}])}),e("el-table-column",{attrs:{label:"等级","min-width":"130"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.grade))])]}}])}),e("el-table-column",{attrs:{label:"一级分佣比例","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s("0.00"==a.row.one_brokerage_percent?a.row.one_brokerage_ratio:a.row.one_brokerage_percent)+"%")])]}}])}),e("el-table-column",{attrs:{label:"二级分佣比例","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s("0.00"==a.row.two_brokerage_percent?a.row.two_brokerage_ratio:a.row.two_brokerage_percent)+"%")])]}}])}),e("el-table-column",{attrs:{label:"任务总数","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.task_total_num))])]}}])}),e("el-table-column",{attrs:{label:"需完成数量","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.task_num))])]}}])}),e("el-table-column",{attrs:{label:"是否显示","min-width":"130"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-switch",{staticClass:"defineSwitch",attrs:{"active-value":1,"inactive-value":0,value:a.row.status,size:"large","active-text":"显示","inactive-text":"隐藏"},on:{change:function(e){return t.onchangeIsShow(a.row)}},model:{value:a.row.status,callback:function(e){t.$set(a.row,"status",e)},expression:"scope.row.status"}})]}}])}),e("el-table-column",{attrs:{label:"操作",fixed:"right",width:"170"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("a",{directives:[{name:"db-click",rawName:"v-db-click"}],on:{click:function(e){return t.addTask(a.row)}}},[t._v("等级任务")]),e("el-divider",{attrs:{direction:"vertical"}}),e("a",{directives:[{name:"db-click",rawName:"v-db-click"}],on:{click:function(e){return t.edit(a.row,"编辑")}}},[t._v("编辑")]),e("el-divider",{attrs:{direction:"vertical"}}),e("a",{directives:[{name:"db-click",rawName:"v-db-click"}],on:{click:function(e){return t.del(a.row,"删除这条信息",a.$index)}}},[t._v("删除")])]}}])})],1),e("div",{staticClass:"acea-row row-right page"},[t.total?e("pagination",{attrs:{total:t.total,page:t.formValidate.page,limit:t.formValidate.limit},on:{"update:page":function(e){return t.$set(t.formValidate,"page",e)},"update:limit":function(e){return t.$set(t.formValidate,"limit",e)},pagination:t.getList}}):t._e()],1)],1),e("div",{staticClass:"task-modal"},[e("el-dialog",{attrs:{visible:t.modal2,title:"添加任务",width:"1000px"},on:{"update:visible":function(e){t.modal2=e}}},[e("el-form",{attrs:{model:t.taskData,"label-width":t.labelWidth,"label-position":t.labelPosition,inline:""}},[e("el-form-item",{attrs:{label:"是否显示："}},[e("el-select",{staticClass:"form_content_width",attrs:{clearable:""},model:{value:t.taskData.status,callback:function(e){t.$set(t.taskData,"status",e)},expression:"taskData.status"}},[e("el-option",{attrs:{value:1,label:"显示"}}),e("el-option",{attrs:{value:0,label:"不显示"}})],1)],1),e("el-form-item",{attrs:{label:"任务名称："}},[e("el-input",{staticClass:"form_content_width",attrs:{placeholder:"请输入任务名称",clearable:""},model:{value:t.taskData.keyword,callback:function(e){t.$set(t.taskData,"keyword",e)},expression:"taskData.keyword"}})],1),e("el-form-item",[e("el-button",{directives:[{name:"db-click",rawName:"v-db-click"}],attrs:{type:"primary"},on:{click:t.searchTask}},[t._v("搜索")])],1)],1),e("div",[e("div",{staticClass:"add-task"},[e("el-button",{directives:[{name:"db-click",rawName:"v-db-click"}],attrs:{type:"primary"},on:{click:function(e){return t.taskAdd()}}},[t._v("添加等级任务")]),e("el-button",{directives:[{name:"db-click",rawName:"v-db-click"}],attrs:{type:"primary"},on:{click:function(e){return t.taskEdit()}}},[t._v("设置完成数量")])],1),e("div",[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.taskLoading,expression:"taskLoading"}],ref:"table",staticClass:"mt14",attrs:{data:t.taskTabList,"highlight-current-row":"","no-userFrom-text":"暂无数据","no-filtered-userFrom-text":"暂无筛选结果"}},[e("el-table-column",{attrs:{label:"ID",width:"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.id))])]}}])}),e("el-table-column",{attrs:{label:"名称","min-width":"130"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.name))])]}}])}),e("el-table-column",{attrs:{label:"任务类型","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.type_name))])]}}])}),e("el-table-column",{attrs:{label:"限定数量","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.number))])]}}])}),e("el-table-column",{attrs:{label:"是否显示","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-switch",{staticClass:"defineSwitch",attrs:{"active-value":1,"inactive-value":0,value:a.row.status,"active-text":"开启","inactive-text":"关闭"},on:{change:function(e){return t.onchangeTaskIsShow(a.row)}},model:{value:a.row.status,callback:function(e){t.$set(a.row,"status",e)},expression:"scope.row.status"}},[e("span",{attrs:{slot:"open"},slot:"open"},[t._v("开启")]),e("span",{attrs:{slot:"close"},slot:"close"},[t._v("关闭")])])]}}])}),e("el-table-column",{attrs:{label:"排序","min-width":"50"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.sort))])]}}])}),e("el-table-column",{attrs:{label:"操作",fixed:"right",width:"170"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("a",{directives:[{name:"db-click",rawName:"v-db-click"}],on:{click:function(e){return t.editTask(a.row,"编辑")}}},[t._v("编辑")]),e("el-divider",{attrs:{direction:"vertical"}}),e("a",{directives:[{name:"db-click",rawName:"v-db-click"}],on:{click:function(e){return t.delTask(a.row,"删除这条信息",a.$index)}}},[t._v("删除")])]}}])})],1)],1)])],1)],1)],1)}),[],!1,null,"49151c57",null);e.default=a.exports},"5dfb":function(t,e,a){},"841c":function(t,e,a){var n=a("c65b"),i=a("d784"),s=a("825a"),r=a("7234"),o=a("1d80"),l=a("129f"),c=a("577e"),u=a("dc4a"),d=a("14c3");i("search",(function(t,e,a){return[function(e){var a=o(this),i=r(e)?void 0:u(e,t);return i?n(i,e,a):new RegExp(e)[t](c(a))},function(t){var n=s(this),i=(t=c(t),a(e,n,t));return i.done?i.value:(i=n.lastIndex,l(i,0)||(n.lastIndex=0),t=d(n,t),l(n.lastIndex,i)||(n.lastIndex=i),null===t?-1:t.index)}]}))},b204:function(t,e,a){a("5dfb")}}]);